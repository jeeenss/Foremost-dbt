[0m17:25:20.782763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106381430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106381100>]}


============================== 17:25:20.786614 | d31f0877-e130-4398-8ac4-a1c1ffbc3ef4 ==============================
[0m17:25:20.786614 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:25:20.787083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:20.798477 [info ] [MainThread]: dbt version: 1.8.8
[0m17:25:20.798809 [info ] [MainThread]: python version: 3.12.6
[0m17:25:20.799026 [info ] [MainThread]: python path: /Users/yeniwijayanti/dbt-env/bin/python
[0m17:25:20.799221 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m17:25:21.647651 [info ] [MainThread]: Using profiles dir at /Users/yeniwijayanti/.dbt
[0m17:25:21.648042 [info ] [MainThread]: Using profiles.yml file at /Users/yeniwijayanti/.dbt/profiles.yml
[0m17:25:21.648263 [info ] [MainThread]: Using dbt_project.yml file at /Users/yeniwijayanti/dbtlearn/dbt_project.yml
[0m17:25:21.648851 [info ] [MainThread]: adapter type: snowflake
[0m17:25:21.649144 [info ] [MainThread]: adapter version: 1.8.4
[0m17:25:21.709742 [info ] [MainThread]: Configuration:
[0m17:25:21.710114 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:25:21.710340 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:25:21.710540 [info ] [MainThread]: Required dependencies:
[0m17:25:21.710801 [debug] [MainThread]: Executing "git --help"
[0m17:25:21.739727 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:25:21.740464 [debug] [MainThread]: STDERR: "b''"
[0m17:25:21.740739 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:25:21.741060 [info ] [MainThread]: Connection:
[0m17:25:21.741389 [info ] [MainThread]:   account: bp59185.europe-west3
[0m17:25:21.741603 [info ] [MainThread]:   user: dbt
[0m17:25:21.741793 [info ] [MainThread]:   database: AIRBNB
[0m17:25:21.741965 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m17:25:21.742141 [info ] [MainThread]:   role: transform
[0m17:25:21.742314 [info ] [MainThread]:   schema: DEV
[0m17:25:21.742487 [info ] [MainThread]:   authenticator: None
[0m17:25:21.742653 [info ] [MainThread]:   oauth_client_id: None
[0m17:25:21.742822 [info ] [MainThread]:   query_tag: None
[0m17:25:21.742987 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:25:21.743151 [info ] [MainThread]:   host: None
[0m17:25:21.743321 [info ] [MainThread]:   port: None
[0m17:25:21.743481 [info ] [MainThread]:   proxy_host: None
[0m17:25:21.743642 [info ] [MainThread]:   proxy_port: None
[0m17:25:21.743805 [info ] [MainThread]:   protocol: None
[0m17:25:21.743984 [info ] [MainThread]:   connect_retries: 1
[0m17:25:21.744149 [info ] [MainThread]:   connect_timeout: None
[0m17:25:21.744310 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:25:21.744478 [info ] [MainThread]:   retry_all: False
[0m17:25:21.744640 [info ] [MainThread]:   insecure_mode: False
[0m17:25:21.745047 [info ] [MainThread]:   reuse_connections: None
[0m17:25:21.745633 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:25:21.778992 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:25:21.780750 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:25:21.781006 [debug] [MainThread]: On debug: select 1 as id
[0m17:25:21.781207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:27.251335 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m17:25:27.251710 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m17:25:27.251977 [debug] [MainThread]: On debug: No close available on handle
[0m17:25:27.252238 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:25:27.252487 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:25:27.252715 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
  Verify that the hostnames and port numbers in SYSTEM$ALLOWLIST are added to your firewall's allowed list.
  To further troubleshoot your connection you may reference the following article: https://docs.snowflake.com/en/user-guide/client-connectivity-troubleshooting/overview.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:25:27.255063 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 6.5288568, "process_user_time": 1.769384, "process_kernel_time": 0.318296, "process_mem_max_rss": "192970752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:25:27.255486 [debug] [MainThread]: Command `dbt debug` failed at 17:25:27.255411 after 6.53 seconds
[0m17:25:27.255736 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:25:27.255996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106381430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbc6a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbab8c0>]}
[0m17:25:27.256314 [debug] [MainThread]: Flushing usage events
[0m17:37:38.015263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065804a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107305490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107305160>]}


============================== 17:37:38.019646 | ee3d39de-7205-4b7f-98dd-5d56981a0882 ==============================
[0m17:37:38.019646 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:37:38.020105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'debug': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:37:38.031291 [info ] [MainThread]: dbt version: 1.8.8
[0m17:37:38.031590 [info ] [MainThread]: python version: 3.12.6
[0m17:37:38.031807 [info ] [MainThread]: python path: /Users/yeniwijayanti/dbt-env/bin/python
[0m17:37:38.031997 [info ] [MainThread]: os info: macOS-14.4.1-arm64-arm-64bit
[0m17:37:38.884008 [info ] [MainThread]: Using profiles dir at /Users/yeniwijayanti/.dbt
[0m17:37:38.884386 [info ] [MainThread]: Using profiles.yml file at /Users/yeniwijayanti/.dbt/profiles.yml
[0m17:37:38.884613 [info ] [MainThread]: Using dbt_project.yml file at /Users/yeniwijayanti/dbtlearn/dbt_project.yml
[0m17:37:38.885164 [info ] [MainThread]: adapter type: snowflake
[0m17:37:38.885456 [info ] [MainThread]: adapter version: 1.8.4
[0m17:37:38.945876 [info ] [MainThread]: Configuration:
[0m17:37:38.946262 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:37:38.946484 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:37:38.946685 [info ] [MainThread]: Required dependencies:
[0m17:37:38.946965 [debug] [MainThread]: Executing "git --help"
[0m17:37:38.977419 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:37:38.978167 [debug] [MainThread]: STDERR: "b''"
[0m17:37:38.978426 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:37:38.978669 [info ] [MainThread]: Connection:
[0m17:37:38.978899 [info ] [MainThread]:   account: bp59185.europe-west3.gcp
[0m17:37:38.979092 [info ] [MainThread]:   user: dbt
[0m17:37:38.979264 [info ] [MainThread]:   database: AIRBNB
[0m17:37:38.979441 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m17:37:38.979611 [info ] [MainThread]:   role: transform
[0m17:37:38.979786 [info ] [MainThread]:   schema: DEV
[0m17:37:38.979955 [info ] [MainThread]:   authenticator: None
[0m17:37:38.980115 [info ] [MainThread]:   oauth_client_id: None
[0m17:37:38.980278 [info ] [MainThread]:   query_tag: None
[0m17:37:38.980443 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:37:38.980601 [info ] [MainThread]:   host: None
[0m17:37:38.980769 [info ] [MainThread]:   port: None
[0m17:37:38.980929 [info ] [MainThread]:   proxy_host: None
[0m17:37:38.981090 [info ] [MainThread]:   proxy_port: None
[0m17:37:38.981252 [info ] [MainThread]:   protocol: None
[0m17:37:38.981407 [info ] [MainThread]:   connect_retries: 1
[0m17:37:38.981565 [info ] [MainThread]:   connect_timeout: None
[0m17:37:38.981723 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:37:38.981883 [info ] [MainThread]:   retry_all: False
[0m17:37:38.982046 [info ] [MainThread]:   insecure_mode: False
[0m17:37:38.982204 [info ] [MainThread]:   reuse_connections: None
[0m17:37:38.982803 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:37:38.989106 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:37:38.990506 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:37:38.990759 [debug] [MainThread]: On debug: select 1 as id
[0m17:37:38.990970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:41.328534 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.337 seconds
[0m17:37:41.332008 [debug] [MainThread]: On debug: Close
[0m17:37:41.846367 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:37:41.847212 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:37:41.852582 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.8920443, "process_user_time": 1.709179, "process_kernel_time": 0.345753, "process_mem_max_rss": "187662336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:37:41.853583 [debug] [MainThread]: Command `dbt debug` succeeded at 17:37:41.853413 after 3.89 seconds
[0m17:37:41.854099 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:37:41.854619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d2ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738f2c0>]}
[0m17:37:41.855157 [debug] [MainThread]: Flushing usage events
[0m17:30:14.144373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077127e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bd9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bd6a0>]}


============================== 17:30:14.148179 | e606e50e-f9bc-45f2-9137-58f08e86b0f8 ==============================
[0m17:30:14.148179 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:30:14.148641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:30:15.070343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e606e50e-f9bc-45f2-9137-58f08e86b0f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107182000>]}
[0m17:30:15.108589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e606e50e-f9bc-45f2-9137-58f08e86b0f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f10aa0>]}
[0m17:30:15.109419 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:30:15.123867 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:30:15.191611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:15.191946 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:15.210122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e606e50e-f9bc-45f2-9137-58f08e86b0f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ba3f0>]}
[0m17:30:15.266969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e606e50e-f9bc-45f2-9137-58f08e86b0f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db1db20>]}
[0m17:30:15.267378 [info ] [MainThread]: Found 1 model, 454 macros
[0m17:30:15.267644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e606e50e-f9bc-45f2-9137-58f08e86b0f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0b7f20>]}
[0m17:30:15.268890 [info ] [MainThread]: 
[0m17:30:15.269320 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:15.269992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:30:15.281666 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:30:15.281954 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:30:15.282177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:16.662641 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.380 seconds
[0m17:30:16.666530 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:30:17.133193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_DEV)
[0m17:30:17.134183 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "DEV"
"
[0m17:30:17.141955 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_DEV"
[0m17:30:17.142463 [debug] [ThreadPool]: On create_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "create_AIRBNB_DEV"} */
create schema if not exists AIRBNB.DEV
[0m17:30:17.142909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:18.333578 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.190 seconds
[0m17:30:18.336646 [debug] [ThreadPool]: On create_AIRBNB_DEV: Close
[0m17:30:18.783064 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_DEV, now list_AIRBNB_DEV)
[0m17:30:18.797782 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:30:18.798246 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m17:30:18.798604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:19.829533 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.031 seconds
[0m17:30:19.834005 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:30:20.378397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e606e50e-f9bc-45f2-9137-58f08e86b0f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db445f0>]}
[0m17:30:20.379424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:20.379967 [info ] [MainThread]: 
[0m17:30:20.383958 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m17:30:20.384612 [info ] [Thread-1 (]: 1 of 1 START sql view model DEV.src_listings ................................... [RUN]
[0m17:30:20.385286 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbtlearn.src_listings'
[0m17:30:20.385744 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m17:30:20.394992 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m17:30:20.396147 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m17:30:20.424779 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m17:30:20.426049 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m17:30:20.426335 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m17:30:20.426586 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:30:21.615238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.188 seconds
[0m17:30:21.647464 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m17:30:22.104730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e606e50e-f9bc-45f2-9137-58f08e86b0f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e70b30>]}
[0m17:30:22.107289 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 1.72s]
[0m17:30:22.108995 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m17:30:22.111728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:22.112262 [debug] [MainThread]: Connection 'list_AIRBNB_DEV' was properly closed.
[0m17:30:22.112683 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m17:30:22.113228 [info ] [MainThread]: 
[0m17:30:22.113865 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.84 seconds (6.84s).
[0m17:30:22.115008 [debug] [MainThread]: Command end result
[0m17:30:22.149846 [info ] [MainThread]: 
[0m17:30:22.150378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:22.150687 [info ] [MainThread]: 
[0m17:30:22.150988 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:30:22.198914 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.106762, "process_user_time": 2.118456, "process_kernel_time": 0.361439, "process_mem_max_rss": "191496192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:30:22.199603 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:22.199501 after 8.11 seconds
[0m17:30:22.200005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088bd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc87410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd2bc80>]}
[0m17:30:22.200370 [debug] [MainThread]: Flushing usage events
[0m17:38:51.337143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106967d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c49880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c49550>]}


============================== 17:38:51.341115 | 4effc53e-1749-4b4b-a167-710c009fbf84 ==============================
[0m17:38:51.341115 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:38:51.341585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:52.294265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4effc53e-1749-4b4b-a167-710c009fbf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bba3620>]}
[0m17:38:52.332842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4effc53e-1749-4b4b-a167-710c009fbf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434d2e0>]}
[0m17:38:52.333743 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:38:52.348384 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:38:52.411510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:52.411861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:52.430092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4effc53e-1749-4b4b-a167-710c009fbf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106964980>]}
[0m17:38:52.487678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4effc53e-1749-4b4b-a167-710c009fbf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb461e0>]}
[0m17:38:52.488087 [info ] [MainThread]: Found 2 models, 454 macros
[0m17:38:52.488350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4effc53e-1749-4b4b-a167-710c009fbf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb316a0>]}
[0m17:38:52.489649 [info ] [MainThread]: 
[0m17:38:52.490083 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:38:52.493388 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:38:52.504908 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:38:52.505183 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:38:52.505399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:53.980877 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.475 seconds
[0m17:38:53.984401 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:38:54.433775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:38:54.448522 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:38:54.448995 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m17:38:54.449317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:55.605337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.156 seconds
[0m17:38:55.610528 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:38:56.066553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4effc53e-1749-4b4b-a167-710c009fbf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11892a900>]}
[0m17:38:56.067757 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:56.068238 [info ] [MainThread]: 
[0m17:38:56.072094 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m17:38:56.072864 [info ] [Thread-1 (]: 1 of 2 START sql view model DEV.src_listings ................................... [RUN]
[0m17:38:56.073438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_listings)
[0m17:38:56.073886 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m17:38:56.083171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m17:38:56.084637 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m17:38:56.113272 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m17:38:56.114305 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m17:38:56.114588 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m17:38:56.114855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:57.332354 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.217 seconds
[0m17:38:57.365841 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m17:38:57.819853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4effc53e-1749-4b4b-a167-710c009fbf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f960b90>]}
[0m17:38:57.821114 [info ] [Thread-1 (]: 1 of 2 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 1.74s]
[0m17:38:57.822102 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m17:38:57.822691 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m17:38:57.823426 [info ] [Thread-1 (]: 2 of 2 START sql view model DEV.src_reviews .................................... [RUN]
[0m17:38:57.824081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m17:38:57.824563 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m17:38:57.827339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m17:38:57.828368 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m17:38:57.832249 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m17:38:57.833458 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m17:38:57.833900 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m17:38:57.834305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:59.100614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.266 seconds
[0m17:38:59.106254 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m17:38:59.547276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4effc53e-1749-4b4b-a167-710c009fbf84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11881ade0>]}
[0m17:38:59.548587 [info ] [Thread-1 (]: 2 of 2 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.72s]
[0m17:38:59.549517 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m17:38:59.551138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:59.551529 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m17:38:59.551991 [info ] [MainThread]: 
[0m17:38:59.552394 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 7.06 seconds (7.06s).
[0m17:38:59.553400 [debug] [MainThread]: Command end result
[0m17:38:59.584745 [info ] [MainThread]: 
[0m17:38:59.585168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:59.585436 [info ] [MainThread]: 
[0m17:38:59.585705 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:38:59.588437 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.304139, "process_user_time": 2.217517, "process_kernel_time": 0.402345, "process_mem_max_rss": "193282048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:38:59.588943 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:59.588853 after 8.30 seconds
[0m17:38:59.589272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066773b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fab7d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ab530>]}
[0m17:38:59.589563 [debug] [MainThread]: Flushing usage events
[0m17:54:01.579563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca69c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb95b0>]}


============================== 17:54:01.583510 | 338c2e1d-47b7-4525-9b89-6c046e72a7a0 ==============================
[0m17:54:01.583510 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:54:01.584001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:02.519538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '338c2e1d-47b7-4525-9b89-6c046e72a7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106781d00>]}
[0m17:54:02.557206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '338c2e1d-47b7-4525-9b89-6c046e72a7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf7e00>]}
[0m17:54:02.557959 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:54:02.572336 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:54:02.636232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:02.636575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:02.654731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '338c2e1d-47b7-4525-9b89-6c046e72a7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29c950>]}
[0m17:54:02.713031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '338c2e1d-47b7-4525-9b89-6c046e72a7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d32f590>]}
[0m17:54:02.713441 [info ] [MainThread]: Found 3 models, 454 macros
[0m17:54:02.713710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338c2e1d-47b7-4525-9b89-6c046e72a7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d286f90>]}
[0m17:54:02.715020 [info ] [MainThread]: 
[0m17:54:02.715447 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:54:02.718879 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:54:02.730640 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:54:02.730919 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:54:02.731139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:04.481015 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.750 seconds
[0m17:54:04.484741 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:54:04.944119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:54:04.956909 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:54:04.957338 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m17:54:04.957655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:06.117184 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.159 seconds
[0m17:54:06.121696 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:54:06.561322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '338c2e1d-47b7-4525-9b89-6c046e72a7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29ddc0>]}
[0m17:54:06.562600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:06.563242 [info ] [MainThread]: 
[0m17:54:06.566858 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m17:54:06.567571 [info ] [Thread-1 (]: 1 of 3 START sql view model DEV.src_hosts ...................................... [RUN]
[0m17:54:06.568143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m17:54:06.568616 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m17:54:06.577701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m17:54:06.578840 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m17:54:06.608273 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m17:54:06.609229 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m17:54:06.609513 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
  );
[0m17:54:06.609768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:08.002665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.392 seconds
[0m17:54:08.033204 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m17:54:09.220060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338c2e1d-47b7-4525-9b89-6c046e72a7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746cb30>]}
[0m17:54:09.221249 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 2.65s]
[0m17:54:09.222103 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m17:54:09.222694 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m17:54:09.223472 [info ] [Thread-1 (]: 2 of 3 START sql view model DEV.src_listings ................................... [RUN]
[0m17:54:09.224287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m17:54:09.224796 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m17:54:09.227912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m17:54:09.230351 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m17:54:09.233901 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m17:54:09.235070 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m17:54:09.235467 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m17:54:09.235842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:10.467151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.231 seconds
[0m17:54:10.478365 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m17:54:10.924373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338c2e1d-47b7-4525-9b89-6c046e72a7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d487bf0>]}
[0m17:54:10.925711 [info ] [Thread-1 (]: 2 of 3 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 1.70s]
[0m17:54:10.926731 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m17:54:10.927453 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m17:54:10.928356 [info ] [Thread-1 (]: 3 of 3 START sql view model DEV.src_reviews .................................... [RUN]
[0m17:54:10.929139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m17:54:10.929657 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m17:54:10.932648 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m17:54:10.935210 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m17:54:10.938969 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m17:54:10.940320 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m17:54:10.940770 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m17:54:10.941228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:12.108081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.166 seconds
[0m17:54:12.113854 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m17:54:12.560349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '338c2e1d-47b7-4525-9b89-6c046e72a7a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d722cc0>]}
[0m17:54:12.561845 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.63s]
[0m17:54:12.562877 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m17:54:12.564435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:12.564838 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m17:54:12.565295 [info ] [MainThread]: 
[0m17:54:12.565718 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 9.85 seconds (9.85s).
[0m17:54:12.566874 [debug] [MainThread]: Command end result
[0m17:54:12.597611 [info ] [MainThread]: 
[0m17:54:12.598003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:12.598259 [info ] [MainThread]: 
[0m17:54:12.598520 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:54:12.601053 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.074199, "process_user_time": 2.212811, "process_kernel_time": 0.362133, "process_mem_max_rss": "193642496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:54:12.601479 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:12.601407 after 11.07 seconds
[0m17:54:12.601911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0bc680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f2ae0>]}
[0m17:54:12.602299 [debug] [MainThread]: Flushing usage events
[0m11:30:55.054843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ebc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c5670>]}


============================== 11:30:55.058984 | afd7a3b0-a97a-4afc-8f78-ebd9847ab73b ==============================
[0m11:30:55.058984 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:30:55.059515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:30:56.027326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afd7a3b0-a97a-4afc-8f78-ebd9847ab73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb7620>]}
[0m11:30:56.065506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afd7a3b0-a97a-4afc-8f78-ebd9847ab73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109877770>]}
[0m11:30:56.066323 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:30:56.080915 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:30:56.153726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:56.154080 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:56.172708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afd7a3b0-a97a-4afc-8f78-ebd9847ab73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c1ed50>]}
[0m11:30:56.233494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afd7a3b0-a97a-4afc-8f78-ebd9847ab73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce58b0>]}
[0m11:30:56.233896 [info ] [MainThread]: Found 4 models, 454 macros
[0m11:30:56.234165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afd7a3b0-a97a-4afc-8f78-ebd9847ab73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b50680>]}
[0m11:30:56.235546 [info ] [MainThread]: 
[0m11:30:56.235982 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:30:56.239427 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m11:30:56.251113 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m11:30:56.251403 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m11:30:56.251618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:57.772151 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.520 seconds
[0m11:30:57.776464 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m11:30:58.244668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m11:30:58.258288 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m11:30:58.258731 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m11:30:58.259058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:59.455350 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.196 seconds
[0m11:30:59.459930 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m11:30:59.910749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afd7a3b0-a97a-4afc-8f78-ebd9847ab73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca6240>]}
[0m11:30:59.911808 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:30:59.912365 [info ] [MainThread]: 
[0m11:30:59.916374 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m11:30:59.917132 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.src_hosts ...................................... [RUN]
[0m11:30:59.917725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m11:30:59.918220 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m11:30:59.927780 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m11:30:59.929386 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m11:30:59.958480 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m11:30:59.959379 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m11:30:59.959665 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
  );
[0m11:30:59.959920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:01.246831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.287 seconds
[0m11:31:01.279037 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m11:31:01.723626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd7a3b0-a97a-4afc-8f78-ebd9847ab73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e7c920>]}
[0m11:31:01.725001 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 1.80s]
[0m11:31:01.725939 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m11:31:01.726512 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m11:31:01.727211 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.src_listings ................................... [RUN]
[0m11:31:01.727880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m11:31:01.728371 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m11:31:01.731079 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m11:31:01.732108 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m11:31:01.736095 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m11:31:01.737428 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m11:31:01.737877 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m11:31:01.738319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:03.066361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.328 seconds
[0m11:31:03.071903 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m11:31:03.507610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd7a3b0-a97a-4afc-8f78-ebd9847ab73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0bcd70>]}
[0m11:31:03.509246 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 1.78s]
[0m11:31:03.510322 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m11:31:03.510886 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m11:31:03.511571 [info ] [Thread-1 (]: 3 of 4 START sql view model DEV.src_reviews .................................... [RUN]
[0m11:31:03.512231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m11:31:03.512780 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m11:31:03.515808 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m11:31:03.517359 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m11:31:03.521225 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m11:31:03.522496 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m11:31:03.522898 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m11:31:03.523295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:04.871525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.348 seconds
[0m11:31:04.877605 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m11:31:05.327687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd7a3b0-a97a-4afc-8f78-ebd9847ab73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a13d9d0>]}
[0m11:31:05.328974 [info ] [Thread-1 (]: 3 of 4 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.82s]
[0m11:31:05.329963 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m11:31:05.330631 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m11:31:05.331483 [info ] [Thread-1 (]: 4 of 4 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m11:31:05.332188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_listings_cleansed)
[0m11:31:05.332662 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m11:31:05.336943 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:31:05.338149 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m11:31:05.341872 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m11:31:05.343334 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:31:05.343761 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH src_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m11:31:05.344183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:06.612875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.268 seconds
[0m11:31:06.618550 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m11:31:07.064671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afd7a3b0-a97a-4afc-8f78-ebd9847ab73b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14b1a0>]}
[0m11:31:07.066102 [info ] [Thread-1 (]: 4 of 4 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.73s]
[0m11:31:07.067061 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m11:31:07.068635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:07.069026 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m11:31:07.069490 [info ] [MainThread]: 
[0m11:31:07.069906 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.83 seconds (10.83s).
[0m11:31:07.071296 [debug] [MainThread]: Command end result
[0m11:31:07.102529 [info ] [MainThread]: 
[0m11:31:07.102906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:31:07.103161 [info ] [MainThread]: 
[0m11:31:07.103422 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:31:07.144551 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.149083, "process_user_time": 2.33224, "process_kernel_time": 0.425045, "process_mem_max_rss": "193380352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:31:07.145212 [debug] [MainThread]: Command `dbt run` succeeded at 11:31:07.145115 after 12.15 seconds
[0m11:31:07.145599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a157110>]}
[0m11:31:07.145951 [debug] [MainThread]: Flushing usage events
[0m11:36:48.836045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106421760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106421430>]}


============================== 11:36:48.840171 | 8bc5f0fc-5a55-425f-8a11-9d5e7db73afa ==============================
[0m11:36:48.840171 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:36:48.840638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:36:49.597066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b40bb60>]}
[0m11:36:49.635407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5e1fa0>]}
[0m11:36:49.636221 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:36:49.649371 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:36:49.717679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:36:49.718061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:36:49.736669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e15b0>]}
[0m11:36:49.794036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b83eb10>]}
[0m11:36:49.794438 [info ] [MainThread]: Found 5 models, 454 macros
[0m11:36:49.794690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8e4320>]}
[0m11:36:49.796075 [info ] [MainThread]: 
[0m11:36:49.796508 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:36:49.799956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m11:36:49.811366 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m11:36:49.811642 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m11:36:49.811856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:51.100355 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.288 seconds
[0m11:36:51.104111 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m11:36:51.554101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m11:36:51.567676 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m11:36:51.568101 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m11:36:51.568452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:52.731909 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.163 seconds
[0m11:36:52.736664 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m11:36:53.177617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba56900>]}
[0m11:36:53.178881 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:53.179627 [info ] [MainThread]: 
[0m11:36:53.183491 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m11:36:53.184196 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m11:36:53.184797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m11:36:53.185305 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m11:36:53.194734 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m11:36:53.196151 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m11:36:53.225340 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m11:36:53.226493 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m11:36:53.226780 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
  );
[0m11:36:53.227031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:54.874285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.647 seconds
[0m11:36:54.915194 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m11:36:55.390454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d0ad0>]}
[0m11:36:55.392401 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 2.20s]
[0m11:36:55.393392 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m11:36:55.394077 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m11:36:55.394888 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listings ................................... [RUN]
[0m11:36:55.395725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m11:36:55.396234 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m11:36:55.400053 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m11:36:55.401446 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m11:36:55.407638 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m11:36:55.410093 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m11:36:55.410809 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m11:36:55.411377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:56.755806 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.344 seconds
[0m11:36:56.759515 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m11:36:57.206204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc0ee40>]}
[0m11:36:57.208635 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 1.81s]
[0m11:36:57.210346 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m11:36:57.211589 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m11:36:57.213161 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m11:36:57.215822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m11:36:57.218327 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m11:36:57.223017 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m11:36:57.224682 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m11:36:57.229681 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m11:36:57.231774 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m11:36:57.232613 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m11:36:57.233505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:58.971911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.738 seconds
[0m11:36:58.979919 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m11:36:59.432790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bca7710>]}
[0m11:36:59.434748 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 2.22s]
[0m11:36:59.436091 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m11:36:59.436830 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m11:36:59.437599 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m11:36:59.438365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m11:36:59.438925 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m11:36:59.444454 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:36:59.445955 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m11:36:59.450834 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:36:59.453329 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:36:59.453933 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS (
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
  );
[0m11:36:59.454473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:00.623955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.169 seconds
[0m11:37:00.631366 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m11:37:01.071493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcd2bd0>]}
[0m11:37:01.074125 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.63s]
[0m11:37:01.075835 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m11:37:01.077122 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m11:37:01.078448 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m11:37:01.079454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m11:37:01.080164 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m11:37:01.088857 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:37:01.090575 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m11:37:01.094613 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m11:37:01.097289 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:37:01.098137 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH src_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m11:37:01.098820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:02.308428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.209 seconds
[0m11:37:02.314574 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m11:37:02.755771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bc5f0fc-5a55-425f-8a11-9d5e7db73afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d0ad0>]}
[0m11:37:02.758358 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.68s]
[0m11:37:02.760120 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m11:37:02.763603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:02.764312 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m11:37:02.765173 [info ] [MainThread]: 
[0m11:37:02.765884 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 12.97 seconds (12.97s).
[0m11:37:02.768730 [debug] [MainThread]: Command end result
[0m11:37:02.808278 [info ] [MainThread]: 
[0m11:37:02.808747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:37:02.809028 [info ] [MainThread]: 
[0m11:37:02.809298 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:37:02.811804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.0255785, "process_user_time": 2.547521, "process_kernel_time": 0.317231, "process_mem_max_rss": "193134592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:37:02.812250 [debug] [MainThread]: Command `dbt run` succeeded at 11:37:02.812175 after 14.03 seconds
[0m11:37:02.812586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f20140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105275250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494fad0>]}
[0m11:37:02.812870 [debug] [MainThread]: Flushing usage events
[0m11:45:26.074143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106151970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106151670>]}


============================== 11:45:26.078341 | afb2e959-adaf-4351-9225-bd35dd674906 ==============================
[0m11:45:26.078341 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:45:26.078859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:27.007706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e60440>]}
[0m11:45:27.046010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105486d80>]}
[0m11:45:27.046805 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:45:27.061433 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:45:27.133486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:27.133815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:27.152658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106133230>]}
[0m11:45:27.211222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115709f40>]}
[0m11:45:27.211627 [info ] [MainThread]: Found 5 models, 454 macros
[0m11:45:27.211889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e60530>]}
[0m11:45:27.213311 [info ] [MainThread]: 
[0m11:45:27.213733 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:45:27.217141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m11:45:27.228799 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m11:45:27.229081 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m11:45:27.229301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:28.655385 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.426 seconds
[0m11:45:28.658137 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m11:45:29.116410 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m11:45:29.125036 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m11:45:29.125385 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m11:45:29.126647 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:30.299293 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.173 seconds
[0m11:45:30.302995 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m11:45:30.744675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156cdc40>]}
[0m11:45:30.745762 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:30.746357 [info ] [MainThread]: 
[0m11:45:30.749576 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m11:45:30.750390 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m11:45:30.751022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m11:45:30.751502 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m11:45:30.760650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m11:45:30.762205 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m11:45:30.794468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m11:45:30.795594 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m11:45:30.795943 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
  );
[0m11:45:30.796261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:32.079150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.282 seconds
[0m11:45:32.112459 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m11:45:32.557618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105704c20>]}
[0m11:45:32.558861 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 1.81s]
[0m11:45:32.559953 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m11:45:32.561126 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m11:45:32.562167 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listings ................................... [RUN]
[0m11:45:32.562869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m11:45:32.563241 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m11:45:32.564943 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m11:45:32.565519 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m11:45:32.569169 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m11:45:32.570163 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m11:45:32.570662 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m11:45:32.571117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:33.705908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.134 seconds
[0m11:45:33.711644 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m11:45:34.162362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116668770>]}
[0m11:45:34.164217 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 1.60s]
[0m11:45:34.165490 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m11:45:34.166237 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m11:45:34.167154 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m11:45:34.168054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m11:45:34.168522 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m11:45:34.171342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m11:45:34.172448 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m11:45:34.176293 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m11:45:34.177651 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m11:45:34.178104 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m11:45:34.178481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:35.447055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.268 seconds
[0m11:45:35.452960 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m11:45:35.898468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11675f410>]}
[0m11:45:35.899885 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.73s]
[0m11:45:35.901187 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m11:45:35.901935 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m11:45:35.902750 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m11:45:35.903480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m11:45:35.903980 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m11:45:35.908437 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:45:35.909454 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m11:45:35.913065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:45:35.914174 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:45:35.914609 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS (
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
  );
[0m11:45:35.915021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:37.082929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.167 seconds
[0m11:45:37.088467 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m11:45:37.539544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116792e70>]}
[0m11:45:37.541357 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.64s]
[0m11:45:37.542521 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m11:45:37.543185 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m11:45:37.543893 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m11:45:37.544598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m11:45:37.545105 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m11:45:37.551186 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:45:37.552513 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m11:45:37.555752 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m11:45:37.557125 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:45:37.557548 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH src_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m11:45:37.557937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:38.820260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.262 seconds
[0m11:45:38.825658 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m11:45:39.277738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb2e959-adaf-4351-9225-bd35dd674906', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116776c90>]}
[0m11:45:39.279234 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.73s]
[0m11:45:39.280333 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m11:45:39.282323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:39.282718 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m11:45:39.283207 [info ] [MainThread]: 
[0m11:45:39.283619 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 12.07 seconds (12.07s).
[0m11:45:39.285112 [debug] [MainThread]: Command end result
[0m11:45:39.314778 [info ] [MainThread]: 
[0m11:45:39.315168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:39.315435 [info ] [MainThread]: 
[0m11:45:39.315696 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:45:39.318318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.302328, "process_user_time": 2.339422, "process_kernel_time": 0.368908, "process_mem_max_rss": "190398464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:45:39.318879 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:39.318797 after 13.30 seconds
[0m11:45:39.319261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca0500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b17f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161f5700>]}
[0m11:45:39.319551 [debug] [MainThread]: Flushing usage events
[0m11:45:57.858323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024b7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f81790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f81460>]}


============================== 11:45:57.862121 | 18c8474c-d8fd-4eb7-a2a0-c0c8b0136657 ==============================
[0m11:45:57.862121 [info ] [MainThread]: Running with dbt=1.8.8
[0m11:45:57.862588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:45:58.589768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bb320>]}
[0m11:45:58.628584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108573620>]}
[0m11:45:58.629526 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:45:58.642454 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m11:45:58.706249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:58.706701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:58.726164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d24dd0>]}
[0m11:45:58.783531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093fb350>]}
[0m11:45:58.783948 [info ] [MainThread]: Found 5 models, 454 macros
[0m11:45:58.784212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093529f0>]}
[0m11:45:58.785604 [info ] [MainThread]: 
[0m11:45:58.786057 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:45:58.789500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m11:45:58.801096 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m11:45:58.801371 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m11:45:58.801598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:00.169326 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.368 seconds
[0m11:46:00.172255 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m11:46:00.618055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m11:46:00.632979 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m11:46:00.633463 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m11:46:00.633807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:01.654307 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.020 seconds
[0m11:46:01.659200 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m11:46:02.104900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920cd70>]}
[0m11:46:02.106119 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:02.106905 [info ] [MainThread]: 
[0m11:46:02.110144 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m11:46:02.110888 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m11:46:02.111481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m11:46:02.111960 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m11:46:02.121297 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m11:46:02.122812 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m11:46:02.152687 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m11:46:02.153623 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m11:46:02.153916 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
  );
[0m11:46:02.154169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:03.455346 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.301 seconds
[0m11:46:03.489339 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m11:46:03.939587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f9160>]}
[0m11:46:03.941087 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 1.83s]
[0m11:46:03.942265 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m11:46:03.942970 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m11:46:03.943710 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listings ................................... [RUN]
[0m11:46:03.944402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m11:46:03.944867 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m11:46:03.947444 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m11:46:03.948805 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m11:46:03.952921 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m11:46:03.954091 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m11:46:03.954512 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m11:46:03.954896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:05.139809 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.184 seconds
[0m11:46:05.145853 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m11:46:05.589248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bc260>]}
[0m11:46:05.590671 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 1.64s]
[0m11:46:05.591862 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m11:46:05.592860 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m11:46:05.593738 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m11:46:05.594585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m11:46:05.595207 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m11:46:05.598280 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m11:46:05.599581 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m11:46:05.603405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m11:46:05.604589 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m11:46:05.604997 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m11:46:05.605380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:06.866097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.260 seconds
[0m11:46:06.872209 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m11:46:07.310218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097f32c0>]}
[0m11:46:07.311687 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.72s]
[0m11:46:07.312799 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m11:46:07.313502 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m11:46:07.314371 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m11:46:07.315135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m11:46:07.315623 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m11:46:07.319931 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:46:07.321872 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m11:46:07.333781 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m11:46:07.341246 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m11:46:07.348084 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:46:07.348414 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m11:46:07.348697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:08.503526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.154 seconds
[0m11:46:08.525795 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m11:46:08.527264 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m11:46:08.527774 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
        );
[0m11:46:09.542390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.014 seconds
[0m11:46:09.547766 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m11:46:09.995991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10980baa0>]}
[0m11:46:09.997349 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.68s]
[0m11:46:09.998340 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m11:46:09.999049 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m11:46:09.999944 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m11:46:10.000702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m11:46:10.001195 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m11:46:10.005486 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m11:46:10.007397 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m11:46:10.010594 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m11:46:10.013221 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m11:46:10.014128 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:46:10.014499 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m11:46:10.014862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:11.056394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.041 seconds
[0m11:46:11.060740 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m11:46:11.063192 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m11:46:11.064172 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (WITH src_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m11:46:12.614802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.549 seconds
[0m11:46:12.620147 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m11:46:13.079122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18c8474c-d8fd-4eb7-a2a0-c0c8b0136657', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098041d0>]}
[0m11:46:13.080861 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 3.08s]
[0m11:46:13.082009 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m11:46:13.083926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:13.084458 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m11:46:13.084966 [info ] [MainThread]: 
[0m11:46:13.085407 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 14.30 seconds (14.30s).
[0m11:46:13.086908 [debug] [MainThread]: Command end result
[0m11:46:13.118823 [info ] [MainThread]: 
[0m11:46:13.119229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:13.119493 [info ] [MainThread]: 
[0m11:46:13.119758 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:46:13.122407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.312777, "process_user_time": 2.486035, "process_kernel_time": 0.321708, "process_mem_max_rss": "193052672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:46:13.122841 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:13.122767 after 15.31 seconds
[0m11:46:13.123154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109459fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039d3860>]}
[0m11:46:13.123451 [debug] [MainThread]: Flushing usage events
[0m12:21:55.452758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066eb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c55b0>]}


============================== 12:21:55.456849 | 5b0e0872-f2de-4adb-a7fc-3d459cf878a8 ==============================
[0m12:21:55.456849 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:21:55.457325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:21:56.389774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8d2270>]}
[0m12:21:56.428294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8cedb0>]}
[0m12:21:56.429063 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:21:56.443582 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:21:56.514940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:56.515279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:56.534315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8f6e40>]}
[0m12:21:56.591536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb2d20>]}
[0m12:21:56.591948 [info ] [MainThread]: Found 6 models, 454 macros
[0m12:21:56.592209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f6e40>]}
[0m12:21:56.593618 [info ] [MainThread]: 
[0m12:21:56.594050 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:21:56.597552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:21:56.609163 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:21:56.609443 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:21:56.609665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:57.967897 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.358 seconds
[0m12:21:57.971919 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:21:58.490594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:21:58.505272 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:21:58.505720 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m12:21:58.506049 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:59.589888 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.084 seconds
[0m12:21:59.594761 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:22:00.047015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc0b170>]}
[0m12:22:00.048162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:00.049023 [info ] [MainThread]: 
[0m12:22:00.052249 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:22:00.052960 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m12:22:00.053549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:22:00.054007 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:22:00.063463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:22:00.064673 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:22:00.094802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m12:22:00.095720 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m12:22:00.096014 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
  );
[0m12:22:00.096265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:01.461961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.365 seconds
[0m12:22:01.495762 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m12:22:02.010240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f78bf0>]}
[0m12:22:02.011469 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 1.96s]
[0m12:22:02.012433 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:22:02.013025 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:22:02.013796 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listings ................................... [RUN]
[0m12:22:02.014549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:22:02.015015 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:22:02.017634 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:22:02.018563 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:22:02.022547 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m12:22:02.024000 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:22:02.024437 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m12:22:02.024843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:03.509116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.484 seconds
[0m12:22:03.515732 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m12:22:03.983253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3d60c0>]}
[0m12:22:03.984405 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 1.97s]
[0m12:22:03.985403 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:22:03.986119 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:22:03.987040 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m12:22:03.987816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:22:03.988271 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:22:03.991267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:22:03.992298 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:22:03.996075 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:22:03.997327 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:22:03.997749 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m12:22:03.998142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:05.185340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.187 seconds
[0m12:22:05.190538 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:22:05.674097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d574440>]}
[0m12:22:05.675304 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.69s]
[0m12:22:05.676281 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:22:05.676954 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:22:05.677730 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m12:22:05.678301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m12:22:05.678854 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:22:05.683343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:22:05.684377 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:22:05.708473 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:22:05.709474 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:22:05.709800 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
        );
[0m12:22:05.710083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:08.434317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.724 seconds
[0m12:22:08.439545 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:22:08.915575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5a5bb0>]}
[0m12:22:08.917135 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 3.24s]
[0m12:22:08.918211 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:22:08.918781 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:22:08.919474 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m12:22:08.920141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m12:22:08.920631 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:22:08.926980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:22:08.928369 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:22:08.931642 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:22:08.933152 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:22:08.933596 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (WITH src_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m12:22:08.934029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:10.880753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.946 seconds
[0m12:22:10.886762 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:22:11.356387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c666060>]}
[0m12:22:11.357548 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.44s]
[0m12:22:11.358426 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:22:11.358962 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:22:11.359650 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m12:22:11.360317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m12:22:11.360822 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m12:22:11.370718 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:22:11.371805 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m12:22:11.404647 [debug] [Thread-1 (]: Invalid value for on_schema_change (faile) specified. Setting default value of ignore.
[0m12:22:11.405266 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m12:22:11.406114 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:22:11.406384 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (
WITH src_reviews AS (
    SELECT * FROM AIRBNB.DEV.src_reviews
)
SELECT 
    * 
FROM 
    src_reviews
WHERE review_text IS NOT NULL

        );
[0m12:22:11.406622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:15.928390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.521 seconds
[0m12:22:15.944294 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:22:15.952919 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:22:15.953378 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m12:22:16.249647 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m12:22:16.254771 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m12:22:16.712954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b0e0872-f2de-4adb-a7fc-3d459cf878a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5ad0d0>]}
[0m12:22:16.714412 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 5.35s]
[0m12:22:16.715708 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:22:16.717781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:16.718267 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m12:22:16.718822 [info ] [MainThread]: 
[0m12:22:16.719291 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 20.12 seconds (20.12s).
[0m12:22:16.721024 [debug] [MainThread]: Command end result
[0m12:22:16.752090 [info ] [MainThread]: 
[0m12:22:16.752534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:16.752803 [info ] [MainThread]: 
[0m12:22:16.753070 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:22:16.755798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.355099, "process_user_time": 2.602143, "process_kernel_time": 0.389746, "process_mem_max_rss": "196345856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:22:16.756364 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:16.756274 after 21.36 seconds
[0m12:22:16.756760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106980c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c713ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b8a180>]}
[0m12:22:16.757062 [debug] [MainThread]: Flushing usage events
[0m12:25:58.350973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a38aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d198b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d19580>]}


============================== 12:25:58.354981 | c7c04e39-264e-4c55-9e80-0e67a0875cce ==============================
[0m12:25:58.354981 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:25:58.355464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:59.201159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ddcd0>]}
[0m12:25:59.239672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1be00>]}
[0m12:25:59.240497 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:25:59.253910 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:25:59.318816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:59.319176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:59.338154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab02420>]}
[0m12:25:59.394910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b90aff0>]}
[0m12:25:59.395324 [info ] [MainThread]: Found 6 models, 454 macros
[0m12:25:59.395582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b743110>]}
[0m12:25:59.396968 [info ] [MainThread]: 
[0m12:25:59.397395 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:59.400960 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:25:59.412658 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:25:59.412940 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:25:59.413166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:00.712700 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.299 seconds
[0m12:26:00.716712 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:26:01.171988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:26:01.186141 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:26:01.186589 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m12:26:01.186935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:02.310350 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.123 seconds
[0m12:26:02.315658 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:26:02.772822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107641700>]}
[0m12:26:02.773691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:02.774134 [info ] [MainThread]: 
[0m12:26:02.777769 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:26:02.778483 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m12:26:02.779052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:26:02.779505 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:26:02.788874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:26:02.790173 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:26:02.818856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m12:26:02.819775 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m12:26:02.820109 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
  );
[0m12:26:02.820445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:04.067561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.247 seconds
[0m12:26:04.100574 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m12:26:04.548923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c8c50>]}
[0m12:26:04.550103 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 1.77s]
[0m12:26:04.551160 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:26:04.551814 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:26:04.552560 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listings ................................... [RUN]
[0m12:26:04.553302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:26:04.553761 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:26:04.556299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:26:04.557158 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:26:04.561371 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m12:26:04.562659 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:26:04.563094 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m12:26:04.563491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:05.809172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.245 seconds
[0m12:26:05.814837 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m12:26:06.331984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b708920>]}
[0m12:26:06.333585 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 1.78s]
[0m12:26:06.334652 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:26:06.335682 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:26:06.336618 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m12:26:06.337282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:26:06.337761 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:26:06.340669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:26:06.341658 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:26:06.345484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:26:06.346754 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:26:06.347186 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m12:26:06.347585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:07.660740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.313 seconds
[0m12:26:07.666671 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:26:08.220332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd57c50>]}
[0m12:26:08.221759 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.88s]
[0m12:26:08.222766 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:26:08.223637 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:26:08.224556 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m12:26:08.225255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m12:26:08.225804 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:26:08.230210 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:26:08.232301 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:26:08.256373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:26:08.257327 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:26:08.257645 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
        );
[0m12:26:08.257931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:10.666580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.408 seconds
[0m12:26:10.672492 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:26:11.153224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bdab4d0>]}
[0m12:26:11.154702 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.93s]
[0m12:26:11.155930 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:26:11.156612 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:26:11.157290 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m12:26:11.157954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m12:26:11.158455 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:26:11.164797 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:26:11.166692 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:26:11.169725 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:26:11.171135 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:26:11.171631 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (WITH src_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m12:26:11.172018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:13.030720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.858 seconds
[0m12:26:13.036348 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:26:13.507078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd766c0>]}
[0m12:26:13.508044 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.35s]
[0m12:26:13.508794 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:26:13.509344 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:26:13.510022 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m12:26:13.510886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m12:26:13.511413 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m12:26:13.520227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:26:13.520913 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m12:26:13.556834 [debug] [Thread-1 (]: Invalid value for on_schema_change (faile) specified. Setting default value of ignore.
[0m12:26:13.557917 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:26:13.558294 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    
WITH src_reviews AS (
    SELECT * FROM AIRBNB.DEV.src_reviews
)
SELECT 
    * 
FROM 
    src_reviews
WHERE review_text IS NOT NULL

AND review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m12:26:13.558599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:15.338057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.779 seconds
[0m12:26:15.354460 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:26:15.355145 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:26:15.611750 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.256 seconds
[0m12:26:15.620200 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:26:15.620903 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m12:26:15.872902 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.251 seconds
[0m12:26:15.887492 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:26:15.888152 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m12:26:16.125339 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.237 seconds
[0m12:26:16.150008 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m12:26:16.151313 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:26:16.151682 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m12:26:16.417497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m12:26:16.418994 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:26:16.419744 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m12:26:17.617535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.197 seconds
[0m12:26:17.619370 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:26:17.620099 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m12:26:17.996141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.375 seconds
[0m12:26:18.012525 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:26:18.021394 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:26:18.021875 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m12:26:18.306378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.284 seconds
[0m12:26:18.311342 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m12:26:18.795429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c04e39-264e-4c55-9e80-0e67a0875cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b908d40>]}
[0m12:26:18.796935 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 5.28s]
[0m12:26:18.798026 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:26:18.800095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:18.800614 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m12:26:18.801172 [info ] [MainThread]: 
[0m12:26:18.801625 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 19.40 seconds (19.40s).
[0m12:26:18.803401 [debug] [MainThread]: Command end result
[0m12:26:18.836234 [info ] [MainThread]: 
[0m12:26:18.836637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:18.836906 [info ] [MainThread]: 
[0m12:26:18.837216 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:26:18.839610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.53781, "process_user_time": 2.737328, "process_kernel_time": 0.326952, "process_mem_max_rss": "194822144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:26:18.840073 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:18.840002 after 20.54 seconds
[0m12:26:18.840386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d19040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10876be90>]}
[0m12:26:18.840676 [debug] [MainThread]: Flushing usage events
[0m12:27:53.975805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b45a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b45760>]}


============================== 12:27:53.979791 | d54a437b-1a88-4057-9499-912d6d2adfcf ==============================
[0m12:27:53.979791 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:27:53.980271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:27:54.739107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd9940>]}
[0m12:27:54.777579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c07890>]}
[0m12:27:54.778353 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:27:54.791881 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:27:54.865613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:54.865948 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:54.884760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f247a0>]}
[0m12:27:54.945820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f92ea0>]}
[0m12:27:54.946252 [info ] [MainThread]: Found 6 models, 454 macros
[0m12:27:54.946524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a10e660>]}
[0m12:27:54.948040 [info ] [MainThread]: 
[0m12:27:54.948485 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:27:54.952033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:27:54.963587 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:27:54.963859 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:27:54.964078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:56.322852 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.359 seconds
[0m12:27:56.326175 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:27:56.796294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:27:56.810548 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:27:56.811011 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m12:27:56.811343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:59.149674 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.338 seconds
[0m12:27:59.158595 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:27:59.625652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f18140>]}
[0m12:27:59.626743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:59.627333 [info ] [MainThread]: 
[0m12:27:59.631264 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:27:59.631998 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m12:27:59.632713 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m12:27:59.633179 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:27:59.642491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:27:59.643701 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:27:59.672468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m12:27:59.673490 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m12:27:59.673799 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
  );
[0m12:27:59.674058 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:28:01.604967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.930 seconds
[0m12:28:01.638818 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m12:28:02.109137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040f8890>]}
[0m12:28:02.110351 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 2.47s]
[0m12:28:02.111371 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:28:02.111936 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:28:02.112689 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listings ................................... [RUN]
[0m12:28:02.113528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:28:02.113997 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:28:02.116698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:28:02.117667 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:28:02.121653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m12:28:02.122906 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:28:02.123322 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m12:28:02.123724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:03.936741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.813 seconds
[0m12:28:03.942568 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m12:28:04.435869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a347590>]}
[0m12:28:04.437239 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 2.32s]
[0m12:28:04.438390 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:28:04.439316 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:28:04.440220 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m12:28:04.441033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:28:04.441530 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:28:04.444529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:28:04.445557 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:28:04.449380 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:28:04.450543 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:28:04.450975 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m12:28:04.451344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:05.568631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.117 seconds
[0m12:28:05.574072 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:28:06.166154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a58be90>]}
[0m12:28:06.168044 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.72s]
[0m12:28:06.169346 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:28:06.170018 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:28:06.170865 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m12:28:06.171504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m12:28:06.171954 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:28:06.176349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:28:06.177557 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:28:06.201485 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:28:06.202377 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:28:06.202698 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
        );
[0m12:28:06.202987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:08.091291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.888 seconds
[0m12:28:08.097459 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:28:08.592125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5af650>]}
[0m12:28:08.593325 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.42s]
[0m12:28:08.594326 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:28:08.595053 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:28:08.595921 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m12:28:08.596633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m12:28:08.597126 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:28:08.603671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:28:08.605828 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:28:08.608811 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:28:08.610163 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:28:08.610605 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (WITH src_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m12:28:08.611001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:10.682603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.071 seconds
[0m12:28:10.687093 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:28:11.160597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a58ea50>]}
[0m12:28:11.162385 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.56s]
[0m12:28:11.163553 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:28:11.164165 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:28:11.164857 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m12:28:11.165570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m12:28:11.166065 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m12:28:11.178091 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:28:11.180239 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m12:28:11.210892 [debug] [Thread-1 (]: Invalid value for on_schema_change (faile) specified. Setting default value of ignore.
[0m12:28:11.211535 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m12:28:11.212358 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:28:11.212634 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (
WITH src_reviews AS (
    SELECT * FROM AIRBNB.DEV.src_reviews
)
SELECT 
    * 
FROM 
    src_reviews
WHERE review_text IS NOT NULL

        );
[0m12:28:11.212891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:14.576394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.363 seconds
[0m12:28:14.591906 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:28:14.600552 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:28:14.601002 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m12:28:14.877600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m12:28:14.883399 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m12:28:15.324822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd54a437b-1a88-4057-9499-912d6d2adfcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a55b0b0>]}
[0m12:28:15.326198 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 4.16s]
[0m12:28:15.327214 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:28:15.329094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:15.329494 [debug] [MainThread]: Connection 'list_AIRBNB_DEV' was properly closed.
[0m12:28:15.329829 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m12:28:15.330331 [info ] [MainThread]: 
[0m12:28:15.330773 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 20.38 seconds (20.38s).
[0m12:28:15.332468 [debug] [MainThread]: Command end result
[0m12:28:15.364096 [info ] [MainThread]: 
[0m12:28:15.364502 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:28:15.364772 [info ] [MainThread]: 
[0m12:28:15.365039 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m12:28:15.367823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.442015, "process_user_time": 2.618283, "process_kernel_time": 0.316585, "process_mem_max_rss": "194691072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:15.368378 [debug] [MainThread]: Command `dbt run` succeeded at 12:28:15.368291 after 21.44 seconds
[0m12:28:15.368706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a053a40>]}
[0m12:28:15.369008 [debug] [MainThread]: Flushing usage events
[0m12:41:22.579727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108251700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108251400>]}


============================== 12:41:22.583528 | 88793cce-f8e5-42b4-821f-1942bd76c662 ==============================
[0m12:41:22.583528 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:41:22.584002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:41:23.521594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af4b020>]}
[0m12:41:23.560156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fca40>]}
[0m12:41:23.560970 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:41:23.574839 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:41:23.637745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:23.638078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:23.656798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d940110>]}
[0m12:41:23.714461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da442c0>]}
[0m12:41:23.714873 [info ] [MainThread]: Found 7 models, 454 macros
[0m12:41:23.715133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9372f0>]}
[0m12:41:23.716569 [info ] [MainThread]: 
[0m12:41:23.716992 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:41:23.720560 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:41:23.732352 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:41:23.732631 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:41:23.732854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:25.028872 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.296 seconds
[0m12:41:25.033064 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:41:25.495687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:41:25.509994 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:41:25.510442 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m12:41:25.510776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:27.294436 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.783 seconds
[0m12:41:27.300080 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:41:27.764350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d942000>]}
[0m12:41:27.765428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:41:27.766109 [info ] [MainThread]: 
[0m12:41:27.769862 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:41:27.770566 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_hosts ...................................... [RUN]
[0m12:41:27.771146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:41:27.771629 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:41:27.780727 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:41:27.781978 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:41:27.811804 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m12:41:27.812802 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m12:41:27.813132 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
  );
[0m12:41:27.813401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:29.240873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.427 seconds
[0m12:41:29.273780 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m12:41:29.970635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db9cfb0>]}
[0m12:41:29.972079 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 2.20s]
[0m12:41:29.973147 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:41:29.973713 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:41:29.974432 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_listings ................................... [RUN]
[0m12:41:29.975232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:41:29.975704 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:41:29.978419 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:41:29.979406 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:41:29.983479 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m12:41:29.984697 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:41:29.985130 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m12:41:29.985529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:31.116023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.130 seconds
[0m12:41:31.122743 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m12:41:31.570301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d97e810>]}
[0m12:41:31.571682 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 1.59s]
[0m12:41:31.572930 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:41:31.573701 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:41:31.574483 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_reviews .................................... [RUN]
[0m12:41:31.575257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:41:31.575745 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:41:31.578766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:41:31.579736 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:41:31.583542 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:41:31.584759 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:41:31.585159 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m12:41:31.585537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:33.768319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.182 seconds
[0m12:41:33.773817 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:41:34.221844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd6f440>]}
[0m12:41:34.223224 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 2.65s]
[0m12:41:34.224246 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:41:34.224939 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:41:34.225740 [info ] [Thread-1 (]: 4 of 7 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m12:41:34.226465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m12:41:34.226939 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:41:34.231348 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:41:34.232633 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:41:34.257384 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:41:34.258326 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:41:34.258659 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH src_hosts AS (
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
        );
[0m12:41:34.258948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:37.030321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.771 seconds
[0m12:41:37.035739 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:41:37.487021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdab8f0>]}
[0m12:41:37.488164 [info ] [Thread-1 (]: 4 of 7 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 3.26s]
[0m12:41:37.489034 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:41:37.489625 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:41:37.490342 [info ] [Thread-1 (]: 5 of 7 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m12:41:37.491022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m12:41:37.491562 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:41:37.498000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:41:37.500089 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:41:37.503117 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:41:37.504453 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:41:37.504860 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (WITH src_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m12:41:37.505261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:39.795047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.289 seconds
[0m12:41:39.800416 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:41:40.245517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7ebf80>]}
[0m12:41:40.246730 [info ] [Thread-1 (]: 5 of 7 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.75s]
[0m12:41:40.247656 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:41:40.248213 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:41:40.248884 [info ] [Thread-1 (]: 6 of 7 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m12:41:40.249584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m12:41:40.250163 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m12:41:40.262631 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:41:40.263567 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m12:41:40.294483 [debug] [Thread-1 (]: Invalid value for on_schema_change (faile) specified. Setting default value of ignore.
[0m12:41:40.295131 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m12:41:40.295914 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:41:40.296183 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (
WITH src_reviews AS (
    SELECT * FROM AIRBNB.DEV.src_reviews
)
SELECT 
    * 
FROM 
    src_reviews
WHERE review_text IS NOT NULL

        );
[0m12:41:40.296428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:44.096784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.800 seconds
[0m12:41:44.113022 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:41:44.121786 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:41:44.122240 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m12:41:44.367914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m12:41:44.373464 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m12:41:44.817320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd2bf80>]}
[0m12:41:44.818522 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 4.57s]
[0m12:41:44.819536 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:41:44.820251 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m12:41:44.821150 [info ] [Thread-1 (]: 7 of 7 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m12:41:44.821840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m12:41:44.822349 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m12:41:44.826938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:41:44.828035 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m12:41:44.831551 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:41:44.832991 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m12:41:44.833444 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listings_cleansed
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT
l.listing_id,
l.listing_name,
l.room_type,
l.minimum_nights,
l.price,
l.host_id,
h.host_name,
h.is_superhost as host_is_superhost,
l.created_at,
GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m12:41:44.833843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:47.475197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.641 seconds
[0m12:41:47.482186 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m12:41:47.921741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88793cce-f8e5-42b4-821f-1942bd76c662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdd31d0>]}
[0m12:41:47.923308 [info ] [Thread-1 (]: 7 of 7 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 3.10s]
[0m12:41:47.924529 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m12:41:47.926355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:47.926823 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m12:41:47.927357 [info ] [MainThread]: 
[0m12:41:47.927818 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 24.21 seconds (24.21s).
[0m12:41:47.929776 [debug] [MainThread]: Command end result
[0m12:41:47.961179 [info ] [MainThread]: 
[0m12:41:47.961581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:47.961843 [info ] [MainThread]: 
[0m12:41:47.962102 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:41:47.964830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.436039, "process_user_time": 2.726279, "process_kernel_time": 0.38729, "process_mem_max_rss": "194297856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:41:47.965332 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:47.965246 after 25.44 seconds
[0m12:41:47.965647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e84500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7ebf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108251400>]}
[0m12:41:47.965936 [debug] [MainThread]: Flushing usage events
[0m12:46:26.826353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b43560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106619940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106619640>]}


============================== 12:46:26.830537 | 862a4016-496d-4118-8e29-df3765f38a4f ==============================
[0m12:46:26.830537 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:46:26.831021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:46:27.600199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '862a4016-496d-4118-8e29-df3765f38a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b877dd0>]}
[0m12:46:27.638192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '862a4016-496d-4118-8e29-df3765f38a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa93770>]}
[0m12:46:27.639000 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:46:27.652948 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:46:27.723480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:27.723829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:27.742954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '862a4016-496d-4118-8e29-df3765f38a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9e5ac0>]}
[0m12:46:27.803516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '862a4016-496d-4118-8e29-df3765f38a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbdae10>]}
[0m12:46:27.803927 [info ] [MainThread]: Found 7 models, 454 macros
[0m12:46:27.804194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862a4016-496d-4118-8e29-df3765f38a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9dc800>]}
[0m12:46:27.805713 [info ] [MainThread]: 
[0m12:46:27.806171 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:46:27.809716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:46:27.821284 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:46:27.821556 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:46:27.821780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:29.143182 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.321 seconds
[0m12:46:29.147292 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:46:29.593396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:46:29.607369 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:46:29.607825 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m12:46:29.608164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:30.777328 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.169 seconds
[0m12:46:30.782659 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:46:31.245072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862a4016-496d-4118-8e29-df3765f38a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9df140>]}
[0m12:46:31.246016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:31.246482 [info ] [MainThread]: 
[0m12:46:31.249684 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:46:31.250424 [info ] [Thread-1 (]: 1 of 7 START sql epheephemeral model DEV.src_hosts ............................. [RUN]
[0m12:46:31.251027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:46:31.251503 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:46:31.261102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:46:31.262285 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:46:31.267979 [debug] [Thread-1 (]: Compilation Error in model src_hosts (models/src/src_hosts.sql)
  No materialization 'epheephemeral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:46:31.269367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '862a4016-496d-4118-8e29-df3765f38a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc4b00>]}
[0m12:46:31.269960 [error] [Thread-1 (]: 1 of 7 ERROR creating sql epheephemeral model DEV.src_hosts .................... [[31mERROR[0m in 0.02s]
[0m12:46:31.270517 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:46:31.270904 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:46:31.271998 [info ] [Thread-1 (]: 2 of 7 START sql epheephemeral model DEV.src_listings .......................... [RUN]
[0m12:46:31.272450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:46:31.272765 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:46:31.274563 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:46:31.275216 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:46:31.277502 [debug] [Thread-1 (]: Compilation Error in model src_listings (models/src/src_listings.sql)
  No materialization 'epheephemeral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:46:31.277807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '862a4016-496d-4118-8e29-df3765f38a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be677a0>]}
[0m12:46:31.278260 [error] [Thread-1 (]: 2 of 7 ERROR creating sql epheephemeral model DEV.src_listings ................. [[31mERROR[0m in 0.01s]
[0m12:46:31.278685 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:46:31.278986 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:46:31.279367 [info ] [Thread-1 (]: 3 of 7 START sql epheephemeral model DEV.src_reviews ........................... [RUN]
[0m12:46:31.279828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:46:31.280173 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:46:31.281698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:46:31.282284 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:46:31.284332 [debug] [Thread-1 (]: Compilation Error in model src_reviews (models/src/src_reviews.sql)
  No materialization 'epheephemeral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:46:31.284660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '862a4016-496d-4118-8e29-df3765f38a4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be6e960>]}
[0m12:46:31.285104 [error] [Thread-1 (]: 3 of 7 ERROR creating sql epheephemeral model DEV.src_reviews .................. [[31mERROR[0m in 0.00s]
[0m12:46:31.285539 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:46:31.285838 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:46:31.286184 [info ] [Thread-1 (]: 4 of 7 SKIP relation DEV.dim_hosts_cleansed .................................... [[33mSKIP[0m]
[0m12:46:31.286644 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:46:31.286984 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:46:31.287299 [info ] [Thread-1 (]: 5 of 7 SKIP relation DEV.dim_listings_cleansed ................................. [[33mSKIP[0m]
[0m12:46:31.287592 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:46:31.287851 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:46:31.288111 [info ] [Thread-1 (]: 6 of 7 SKIP relation DEV.fct_reviews ........................................... [[33mSKIP[0m]
[0m12:46:31.288433 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:46:31.288696 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m12:46:31.288953 [info ] [Thread-1 (]: 7 of 7 SKIP relation DEV.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m12:46:31.289213 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m12:46:31.289980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:31.290177 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m12:46:31.290426 [info ] [MainThread]: 
[0m12:46:31.290654 [info ] [MainThread]: Finished running 3 epheephemeral models, 3 table models, 1 incremental model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m12:46:31.291343 [debug] [MainThread]: Command end result
[0m12:46:31.312152 [info ] [MainThread]: 
[0m12:46:31.312499 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:46:31.312732 [info ] [MainThread]: 
[0m12:46:31.313019 [error] [MainThread]:   Compilation Error in model src_hosts (models/src/src_hosts.sql)
  No materialization 'epheephemeral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:46:31.313231 [info ] [MainThread]: 
[0m12:46:31.313487 [error] [MainThread]:   Compilation Error in model src_listings (models/src/src_listings.sql)
  No materialization 'epheephemeral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:46:31.313683 [info ] [MainThread]: 
[0m12:46:31.313919 [error] [MainThread]:   Compilation Error in model src_reviews (models/src/src_reviews.sql)
  No materialization 'epheephemeral' was found for adapter snowflake! (searched types 'default' and 'snowflake')
[0m12:46:31.314116 [info ] [MainThread]: 
[0m12:46:31.314336 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=4 TOTAL=7
[0m12:46:31.316360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.5401654, "process_user_time": 1.913196, "process_kernel_time": 0.279758, "process_mem_max_rss": "193413120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:46:31.316745 [debug] [MainThread]: Command `dbt run` failed at 12:46:31.316683 after 4.54 seconds
[0m12:46:31.317030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106214140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b43560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc4b00>]}
[0m12:46:31.317273 [debug] [MainThread]: Flushing usage events
[0m12:47:59.329278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107157410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f099a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f09670>]}


============================== 12:47:59.333213 | 955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab ==============================
[0m12:47:59.333213 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:47:59.333734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:48:00.086387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f649e0>]}
[0m12:48:00.123983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107553440>]}
[0m12:48:00.124752 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:48:00.137997 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:48:00.203212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:00.203542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:00.222501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149d2a20>]}
[0m12:48:00.283827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bcc110>]}
[0m12:48:00.284268 [info ] [MainThread]: Found 7 models, 454 macros
[0m12:48:00.284539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bb6a20>]}
[0m12:48:00.286082 [info ] [MainThread]: 
[0m12:48:00.286558 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:48:00.290051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:48:00.301710 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:48:00.302000 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:48:00.302222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:01.915471 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.613 seconds
[0m12:48:01.919004 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:48:02.380404 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:48:02.394538 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:48:02.395005 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m12:48:02.395364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:03.588876 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.193 seconds
[0m12:48:03.594480 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:48:04.035891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11238a2d0>]}
[0m12:48:04.036720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:04.037155 [info ] [MainThread]: 
[0m12:48:04.040923 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:48:04.041479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:48:04.041951 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:48:04.051061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:48:04.052820 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:48:04.053275 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:48:04.053746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:48:04.054138 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:48:04.057611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:48:04.058451 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:48:04.058817 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:48:04.059184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:48:04.059530 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:48:04.061266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:48:04.061956 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:48:04.062329 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:48:04.062810 [info ] [Thread-1 (]: 1 of 4 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m12:48:04.063378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m12:48:04.063775 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:48:04.068335 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:48:04.069262 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:48:04.093856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:48:04.094972 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:48:04.095277 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
), src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
        );
[0m12:48:04.095543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:06.153608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.058 seconds
[0m12:48:06.189364 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:48:06.635879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120860e60>]}
[0m12:48:06.637104 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.57s]
[0m12:48:06.637943 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:48:06.638490 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:48:06.639210 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m12:48:06.639878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m12:48:06.640379 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:48:06.649171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:48:06.651055 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:48:06.654185 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:48:06.656021 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:48:06.656493 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS(
    SELECT * FROM __dbt__cte__src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m12:48:06.656892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:08.917025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.259 seconds
[0m12:48:08.923388 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:48:09.356412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12236eae0>]}
[0m12:48:09.357857 [info ] [Thread-1 (]: 2 of 4 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.72s]
[0m12:48:09.358715 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:48:09.359550 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:48:09.360707 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m12:48:09.361670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m12:48:09.362302 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m12:48:09.377251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:48:09.379435 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m12:48:09.410441 [debug] [Thread-1 (]: Invalid value for on_schema_change (faile) specified. Setting default value of ignore.
[0m12:48:09.415167 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:48:09.415498 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT 
    * 
FROM 
    src_reviews
WHERE review_text IS NOT NULL

AND review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m12:48:09.415780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:10.564543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.148 seconds
[0m12:48:10.579896 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:48:10.580554 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:48:10.826983 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.246 seconds
[0m12:48:10.835016 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:48:10.835627 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m12:48:11.088499 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.252 seconds
[0m12:48:11.102153 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:48:11.102718 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m12:48:11.374467 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.271 seconds
[0m12:48:11.401524 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m12:48:11.402836 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:48:11.403190 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m12:48:11.657306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.253 seconds
[0m12:48:11.658420 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:48:11.659166 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m12:48:12.408916 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.748 seconds
[0m12:48:12.410677 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:48:12.411466 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m12:48:12.692610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m12:48:12.707985 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:48:12.716495 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:48:12.716934 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m12:48:12.981757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m12:48:12.986771 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m12:48:13.419286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223b9af0>]}
[0m12:48:13.420487 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 4.06s]
[0m12:48:13.421488 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:48:13.422205 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m12:48:13.423102 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m12:48:13.423818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m12:48:13.424344 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m12:48:13.428850 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:48:13.429840 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m12:48:13.433365 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:48:13.434839 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m12:48:13.435310 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listings_cleansed
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT
l.listing_id,
l.listing_name,
l.room_type,
l.minimum_nights,
l.price,
l.host_id,
h.host_name,
h.is_superhost as host_is_superhost,
l.created_at,
GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m12:48:13.435722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:15.394990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.959 seconds
[0m12:48:15.400931 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m12:48:15.845304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '955cab0a-1c93-4a5a-9ac7-3c5ab55ee0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223d92b0>]}
[0m12:48:15.846464 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.42s]
[0m12:48:15.848060 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m12:48:15.849851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:15.850441 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m12:48:15.851030 [info ] [MainThread]: 
[0m12:48:15.851315 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 15.56 seconds (15.56s).
[0m12:48:15.852222 [debug] [MainThread]: Command end result
[0m12:48:15.883322 [info ] [MainThread]: 
[0m12:48:15.884169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:15.884733 [info ] [MainThread]: 
[0m12:48:15.885061 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:48:15.888321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.607359, "process_user_time": 2.483633, "process_kernel_time": 0.301487, "process_mem_max_rss": "193347584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:48:15.889945 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:15.889800 after 16.61 seconds
[0m12:48:15.890407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ec0f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1223c3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111794380>]}
[0m12:48:15.892664 [debug] [MainThread]: Flushing usage events
[0m12:49:21.737300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a3bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d198b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d195b0>]}


============================== 12:49:21.741411 | 4ab3e1f7-9ccc-4f27-91f1-8507556a4280 ==============================
[0m12:49:21.741411 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:49:21.741915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:49:22.690118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ab3e1f7-9ccc-4f27-91f1-8507556a4280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba17800>]}
[0m12:49:22.728349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ab3e1f7-9ccc-4f27-91f1-8507556a4280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d19f770>]}
[0m12:49:22.729110 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:49:22.743065 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:49:22.816431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:22.816772 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:22.835425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ab3e1f7-9ccc-4f27-91f1-8507556a4280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e076f90>]}
[0m12:49:22.892266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ab3e1f7-9ccc-4f27-91f1-8507556a4280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1fc470>]}
[0m12:49:22.892665 [info ] [MainThread]: Found 7 models, 454 macros
[0m12:49:22.892929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab3e1f7-9ccc-4f27-91f1-8507556a4280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e3110>]}
[0m12:49:22.894345 [info ] [MainThread]: 
[0m12:49:22.894784 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:22.898213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:49:22.909808 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:49:22.910082 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:49:22.910301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:24.192814 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.282 seconds
[0m12:49:24.196794 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:49:24.648117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:49:24.662578 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:49:24.663031 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m12:49:24.663392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:49:25.862534 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.199 seconds
[0m12:49:25.867720 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:49:26.332775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab3e1f7-9ccc-4f27-91f1-8507556a4280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddf1970>]}
[0m12:49:26.333745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:26.334210 [info ] [MainThread]: 
[0m12:49:26.337939 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:49:26.338547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:49:26.339024 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:49:26.348425 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:49:26.349970 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:49:26.350432 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:49:26.350916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:49:26.351318 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:49:26.354758 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:49:26.355607 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:49:26.355963 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:49:26.356331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:49:26.356659 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:49:26.358432 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:49:26.359155 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:49:26.359499 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:49:26.359949 [info ] [Thread-1 (]: 1 of 4 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m12:49:26.360415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m12:49:26.360779 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:49:26.365561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:49:26.366299 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:49:26.391340 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:49:26.392529 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:49:26.392838 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
), src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
        );
[0m12:49:26.393103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:28.213468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.820 seconds
[0m12:49:28.247776 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:49:28.702903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab3e1f7-9ccc-4f27-91f1-8507556a4280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df18da0>]}
[0m12:49:28.704335 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.34s]
[0m12:49:28.705498 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:49:28.706110 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:49:28.706864 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m12:49:28.707571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m12:49:28.708102 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:49:28.717081 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:49:28.718515 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:49:28.721583 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:49:28.723376 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:49:28.723871 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS(
    SELECT * FROM __dbt__cte__src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
        );
[0m12:49:28.724275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:30.633383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.909 seconds
[0m12:49:30.639177 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:49:31.090732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab3e1f7-9ccc-4f27-91f1-8507556a4280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e790a10>]}
[0m12:49:31.092353 [info ] [Thread-1 (]: 2 of 4 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 2.38s]
[0m12:49:31.093716 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:49:31.094571 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:49:31.095513 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m12:49:31.096364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m12:49:31.096830 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m12:49:31.110989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:49:31.113105 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m12:49:31.144837 [debug] [Thread-1 (]: Invalid value for on_schema_change (faile) specified. Setting default value of ignore.
[0m12:49:31.149685 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:49:31.150017 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT 
    * 
FROM 
    src_reviews
WHERE review_text IS NOT NULL

AND review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m12:49:31.150297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:32.247602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.097 seconds
[0m12:49:32.265824 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:49:32.266990 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:49:32.527722 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.260 seconds
[0m12:49:32.539273 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:49:32.540303 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m12:49:32.780677 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.239 seconds
[0m12:49:32.796884 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:49:32.797610 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m12:49:33.032597 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.234 seconds
[0m12:49:33.064016 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m12:49:33.065406 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:49:33.065853 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m12:49:33.330161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m12:49:33.331245 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:49:33.331917 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m12:49:33.678323 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.346 seconds
[0m12:49:33.679850 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:49:33.680619 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m12:49:33.979378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m12:49:33.995222 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:49:34.008500 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:49:34.009166 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m12:49:34.279738 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m12:49:34.286091 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m12:49:34.731723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab3e1f7-9ccc-4f27-91f1-8507556a4280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7cf620>]}
[0m12:49:34.734000 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 3.64s]
[0m12:49:34.735415 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:49:34.736342 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m12:49:34.737429 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m12:49:34.738419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m12:49:34.739220 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m12:49:34.745969 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:49:34.747606 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m12:49:34.751865 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:49:34.753877 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m12:49:34.754470 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listings_cleansed
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT
l.listing_id,
l.listing_name,
l.room_type,
l.minimum_nights,
l.price,
l.host_id,
h.host_name,
h.is_superhost as host_is_superhost,
l.created_at,
GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m12:49:34.754958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:36.611132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.856 seconds
[0m12:49:36.616191 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m12:49:37.050975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab3e1f7-9ccc-4f27-91f1-8507556a4280', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7b1790>]}
[0m12:49:37.052320 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.31s]
[0m12:49:37.054006 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m12:49:37.057364 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:37.058014 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m12:49:37.058648 [info ] [MainThread]: 
[0m12:49:37.059126 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 14.16 seconds (14.16s).
[0m12:49:37.060868 [debug] [MainThread]: Command end result
[0m12:49:37.094828 [info ] [MainThread]: 
[0m12:49:37.095318 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:37.095752 [info ] [MainThread]: 
[0m12:49:37.096103 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:49:37.103364 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.418925, "process_user_time": 2.523001, "process_kernel_time": 0.373992, "process_mem_max_rss": "195592192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:49:37.104471 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:37.104247 after 15.42 seconds
[0m12:49:37.105004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d19040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e408140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcca570>]}
[0m12:49:37.105670 [debug] [MainThread]: Flushing usage events
[0m12:57:06.019033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10325b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d298b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d295b0>]}


============================== 12:57:06.023130 | 00c2bc53-93c4-4674-8a95-5d629e40ec5e ==============================
[0m12:57:06.023130 [info ] [MainThread]: Running with dbt=1.8.8
[0m12:57:06.023604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'debug': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:06.781134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00c2bc53-93c4-4674-8a95-5d629e40ec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2c6b0>]}
[0m12:57:06.820069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00c2bc53-93c4-4674-8a95-5d629e40ec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bdca10>]}
[0m12:57:06.820871 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:57:06.834121 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m12:57:06.906483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:06.906821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:06.925900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00c2bc53-93c4-4674-8a95-5d629e40ec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4f1d0>]}
[0m12:57:06.985081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00c2bc53-93c4-4674-8a95-5d629e40ec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1479e0>]}
[0m12:57:06.985471 [info ] [MainThread]: Found 7 models, 454 macros
[0m12:57:06.985736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c2bc53-93c4-4674-8a95-5d629e40ec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf6c00>]}
[0m12:57:06.987192 [info ] [MainThread]: 
[0m12:57:06.987620 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:57:06.991054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:57:07.002711 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:57:07.002985 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:57:07.003207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:08.309811 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.306 seconds
[0m12:57:08.313898 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:57:08.772919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:57:08.787127 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:57:08.787578 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m12:57:08.787948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:10.096243 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.308 seconds
[0m12:57:10.101737 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:57:10.552134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c2bc53-93c4-4674-8a95-5d629e40ec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a068260>]}
[0m12:57:10.553276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:10.553823 [info ] [MainThread]: 
[0m12:57:10.557597 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:57:10.558236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:57:10.558733 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:57:10.568432 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:57:10.570028 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:57:10.570496 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:57:10.570999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:57:10.571464 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:57:10.574862 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:57:10.575743 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:57:10.576095 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:57:10.576513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:57:10.576824 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:57:10.578546 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:57:10.579301 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:57:10.579652 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:57:10.580125 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m12:57:10.580522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m12:57:10.580817 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:57:10.585905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:57:10.586844 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:57:10.606313 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type table
[0m12:57:10.611164 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m12:57:10.615777 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:57:10.616069 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m12:57:10.616325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:11.814169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.197 seconds
[0m12:57:11.835263 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:57:11.837031 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:57:11.837506 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    
WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
), src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
  );
[0m12:57:12.218066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m12:57:12.248674 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:57:12.720129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c2bc53-93c4-4674-8a95-5d629e40ec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f2c7d0>]}
[0m12:57:12.721170 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 2.14s]
[0m12:57:12.722015 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:57:12.722571 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:57:12.723321 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m12:57:12.723963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m12:57:12.724446 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:57:12.733589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:57:12.735358 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:57:12.738378 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type table
[0m12:57:12.740815 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m12:57:12.741717 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:57:12.742075 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m12:57:12.742397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:14.510795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.768 seconds
[0m12:57:14.514730 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:57:14.517757 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:57:14.518403 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    
WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS(
    SELECT * FROM __dbt__cte__src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m12:57:15.017494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m12:57:15.022664 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:57:15.466506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c2bc53-93c4-4674-8a95-5d629e40ec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5cf560>]}
[0m12:57:15.467726 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 2.74s]
[0m12:57:15.468716 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:57:15.469449 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m12:57:15.470302 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m12:57:15.470991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m12:57:15.471526 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m12:57:15.483989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m12:57:15.484848 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m12:57:15.516308 [debug] [Thread-1 (]: Invalid value for on_schema_change (faile) specified. Setting default value of ignore.
[0m12:57:15.517359 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:57:15.517659 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT 
    * 
FROM 
    src_reviews
WHERE review_text IS NOT NULL

AND review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m12:57:15.517917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:16.637333 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.119 seconds
[0m12:57:16.653315 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:57:16.653939 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:57:16.931286 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.277 seconds
[0m12:57:16.938811 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:57:16.939409 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m12:57:17.184517 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.244 seconds
[0m12:57:17.199165 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:57:17.199758 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m12:57:17.443643 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.243 seconds
[0m12:57:17.471476 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m12:57:17.472812 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:57:17.473224 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m12:57:17.732720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m12:57:17.734097 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:57:17.734919 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m12:57:18.602919 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.867 seconds
[0m12:57:18.604327 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:57:18.604980 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m12:57:18.899094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m12:57:18.907807 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:57:18.912064 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m12:57:18.912608 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m12:57:19.189459 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m12:57:19.194858 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m12:57:19.641948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c2bc53-93c4-4674-8a95-5d629e40ec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a517890>]}
[0m12:57:19.643422 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 4.17s]
[0m12:57:19.644760 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m12:57:19.645487 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m12:57:19.646280 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m12:57:19.646954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m12:57:19.647466 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m12:57:19.651556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:57:19.653772 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m12:57:19.679126 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m12:57:19.680327 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m12:57:19.680657 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listings_cleansed
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT
l.listing_id,
l.listing_name,
l.room_type,
l.minimum_nights,
l.price,
l.host_id,
h.host_name,
h.is_superhost as host_is_superhost,
l.created_at,
GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m12:57:19.680953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:22.186174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.505 seconds
[0m12:57:22.197598 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m12:57:22.639922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00c2bc53-93c4-4674-8a95-5d629e40ec5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6644d0>]}
[0m12:57:22.641393 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.99s]
[0m12:57:22.642443 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m12:57:22.644439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:22.644846 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m12:57:22.645344 [info ] [MainThread]: 
[0m12:57:22.645790 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 15.66 seconds (15.66s).
[0m12:57:22.647246 [debug] [MainThread]: Command end result
[0m12:57:22.678449 [info ] [MainThread]: 
[0m12:57:22.678841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:22.679099 [info ] [MainThread]: 
[0m12:57:22.679370 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:57:22.681870 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.717358, "process_user_time": 2.571591, "process_kernel_time": 0.320551, "process_mem_max_rss": "193855488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:57:22.682386 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:22.682311 after 16.72 seconds
[0m12:57:22.682707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d29730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a10e570>]}
[0m12:57:22.682993 [debug] [MainThread]: Flushing usage events
[0m19:32:54.342284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b82ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d45610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d452e0>]}


============================== 19:32:54.346130 | 8b5ae7d3-4947-4552-8999-1c0e1cf0768c ==============================
[0m19:32:54.346130 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:32:54.346589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:32:55.328042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b5ae7d3-4947-4552-8999-1c0e1cf0768c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11571b320>]}
[0m19:32:55.366451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b5ae7d3-4947-4552-8999-1c0e1cf0768c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115792660>]}
[0m19:32:55.367322 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:32:55.381908 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:32:55.456100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:32:55.456559 [debug] [MainThread]: Partial parsing: added file: dbtlearn://seeds/seed_full_moon_dates.csv
[0m19:32:55.608427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b5ae7d3-4947-4552-8999-1c0e1cf0768c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201e32c0>]}
[0m19:32:55.672125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b5ae7d3-4947-4552-8999-1c0e1cf0768c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f5ff80>]}
[0m19:32:55.672518 [info ] [MainThread]: Found 7 models, 1 seed, 454 macros
[0m19:32:55.672779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b5ae7d3-4947-4552-8999-1c0e1cf0768c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116fcc0e0>]}
[0m19:32:55.674137 [info ] [MainThread]: 
[0m19:32:55.674561 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:32:55.675324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:32:55.685634 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:32:55.685917 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:32:55.686128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:57.633979 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.948 seconds
[0m19:32:57.637163 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:32:58.255820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m19:32:58.267954 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:32:58.268432 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m19:32:58.268765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:33:01.429579 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.161 seconds
[0m19:33:01.436106 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:33:01.877932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b5ae7d3-4947-4552-8999-1c0e1cf0768c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116fcc0e0>]}
[0m19:33:01.879661 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:01.880676 [info ] [MainThread]: 
[0m19:33:01.885963 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m19:33:01.887256 [info ] [Thread-1 (]: 1 of 1 START seed file DEV.seed_full_moon_dates ................................ [RUN]
[0m19:33:01.888750 [debug] [Thread-1 (]: Acquiring new snowflake connection 'seed.dbtlearn.seed_full_moon_dates'
[0m19:33:01.889433 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m19:33:01.890005 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m19:33:01.937655 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m19:33:01.938080 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
create table AIRBNB.DEV.seed_full_moon_dates (full_moon_date date)
[0m19:33:01.938339 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:33:04.312979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.374 seconds
[0m19:33:04.338969 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m19:33:04.339600 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
BEGIN
[0m19:33:04.669793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m19:33:04.675006 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m19:33:04.675911 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
insert into AIRBNB.DEV.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s...
[0m19:33:06.130008 [debug] [Thread-1 (]: SQL status: SUCCESS 272 in 1.453 seconds
[0m19:33:06.131631 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m19:33:06.132429 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
COMMIT
[0m19:33:06.506660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.373 seconds
[0m19:33:06.517960 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m19:33:06.546445 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: Close
[0m19:33:06.990116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b5ae7d3-4947-4552-8999-1c0e1cf0768c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db8b00>]}
[0m19:33:06.990929 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file DEV.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 5.10s]
[0m19:33:06.991538 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m19:33:06.992748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:06.993103 [debug] [MainThread]: Connection 'list_AIRBNB_DEV' was properly closed.
[0m19:33:06.993337 [debug] [MainThread]: Connection 'seed.dbtlearn.seed_full_moon_dates' was properly closed.
[0m19:33:06.993610 [info ] [MainThread]: 
[0m19:33:06.993908 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 11.32 seconds (11.32s).
[0m19:33:06.994458 [debug] [MainThread]: Command end result
[0m19:33:07.025405 [info ] [MainThread]: 
[0m19:33:07.025864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:33:07.026143 [info ] [MainThread]: 
[0m19:33:07.026410 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:33:07.061766 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.777002, "process_user_time": 2.322802, "process_kernel_time": 0.442974, "process_mem_max_rss": "196935680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:33:07.062326 [debug] [MainThread]: Command `dbt seed` succeeded at 19:33:07.062241 after 12.78 seconds
[0m19:33:07.062656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201e2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d45580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d455e0>]}
[0m19:33:07.062960 [debug] [MainThread]: Flushing usage events
[0m19:45:00.947177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653d760>]}


============================== 19:45:00.951191 | 4899de41-ec1f-4ed4-ba99-60c47f35cc89 ==============================
[0m19:45:00.951191 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:45:00.951637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:45:01.860848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdbb4a0>]}
[0m19:45:01.899182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce4bdd0>]}
[0m19:45:01.900001 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:45:01.914502 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:45:01.997888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:45:01.998239 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:45:02.024086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3c3c20>]}
[0m19:45:02.090020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4054c0>]}
[0m19:45:02.090407 [info ] [MainThread]: Found 8 models, 1 seed, 454 macros
[0m19:45:02.090687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5bb7a0>]}
[0m19:45:02.092141 [info ] [MainThread]: 
[0m19:45:02.092557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:45:02.095995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:45:02.107462 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:45:02.107729 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:45:02.107944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:04.581381 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.473 seconds
[0m19:45:04.585534 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:45:05.034050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m19:45:05.047697 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:45:05.048132 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m19:45:05.048464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:07.222079 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.173 seconds
[0m19:45:07.226615 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:45:07.672133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e69730>]}
[0m19:45:07.673188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:45:07.673648 [info ] [MainThread]: 
[0m19:45:07.677500 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m19:45:07.678239 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbtlearn.src_hosts'
[0m19:45:07.678721 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m19:45:07.689532 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m19:45:07.692253 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m19:45:07.692730 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m19:45:07.693239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m19:45:07.693655 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m19:45:07.695663 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m19:45:07.696507 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m19:45:07.696862 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m19:45:07.697230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m19:45:07.697560 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m19:45:07.699317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m19:45:07.700221 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m19:45:07.700590 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m19:45:07.701056 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m19:45:07.701509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m19:45:07.701859 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m19:45:07.706673 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m19:45:07.708163 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m19:45:07.731676 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m19:45:07.733004 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m19:45:07.733333 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    
WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT
    id AS host_id, 
    name AS host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM 
    raw_hosts
), src_hosts AS (
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id, 
    NVL(host_name,'Anonymous') host_name, 
    is_superhost,
    created_at, 
    updated_at
FROM
    src_hosts
  );
[0m19:45:07.733610 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:45:09.607442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.873 seconds
[0m19:45:09.641934 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m19:45:11.106373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d160c50>]}
[0m19:45:11.107866 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 3.40s]
[0m19:45:11.108749 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m19:45:11.109332 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m19:45:11.110052 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m19:45:11.110733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m19:45:11.111218 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m19:45:11.120906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m19:45:11.122795 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m19:45:11.126089 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m19:45:11.127942 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m19:45:11.128463 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    
WITH  __dbt__cte__src_listings as (
WITH raw_listings AS (
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings AS(
    SELECT * FROM __dbt__cte__src_listings
)
SELECT
    listing_id,
    listing_name,
    room_type,
    CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(
    price_str,
    '$'
    ) :: NUMBER(
    10,
    2
    ) AS price,
    created_at,
    updated_at
FROM
    src_listings
  );
[0m19:45:11.128915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:12.542632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.413 seconds
[0m19:45:12.548114 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m19:45:12.996675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e308ce0>]}
[0m19:45:12.998045 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.89s]
[0m19:45:12.999086 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m19:45:12.999779 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m19:45:13.000621 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m19:45:13.001459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m19:45:13.002048 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m19:45:13.018888 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m19:45:13.021094 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m19:45:13.049920 [debug] [Thread-1 (]: Invalid value for on_schema_change (faile) specified. Setting default value of ignore.
[0m19:45:13.050955 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m19:45:13.051255 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    
WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id, 
    date AS review_date, 
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS (
    SELECT * FROM __dbt__cte__src_reviews
)
SELECT 
    * 
FROM 
    src_reviews
WHERE review_text IS NOT NULL

AND review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m19:45:13.051522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:14.369476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.317 seconds
[0m19:45:14.385864 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m19:45:14.386514 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m19:45:15.101132 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.714 seconds
[0m19:45:15.108705 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m19:45:15.109322 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m19:45:15.368320 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.258 seconds
[0m19:45:15.382075 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m19:45:15.382710 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m19:45:15.638946 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.255 seconds
[0m19:45:15.666189 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m19:45:15.668451 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m19:45:15.668821 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m19:45:15.941944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m19:45:15.943129 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m19:45:15.943746 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m19:45:16.758608 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.814 seconds
[0m19:45:16.759904 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m19:45:16.760395 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m19:45:17.048761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m19:45:17.063911 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m19:45:17.072406 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m19:45:17.072919 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m19:45:17.352448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.279 seconds
[0m19:45:17.356996 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m19:45:17.798210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3e48c0>]}
[0m19:45:17.799992 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 4.80s]
[0m19:45:17.801204 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m19:45:17.801788 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m19:45:17.802589 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m19:45:17.803406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m19:45:17.803891 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m19:45:17.808391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m19:45:17.810710 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m19:45:17.833900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m19:45:17.835233 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m19:45:17.835568 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listings_cleansed
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT
l.listing_id,
l.listing_name,
l.room_type,
l.minimum_nights,
l.price,
l.host_id,
h.host_name,
h.is_superhost as host_is_superhost,
l.created_at,
GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m19:45:17.835862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:21.636130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.800 seconds
[0m19:45:21.641660 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m19:45:22.079043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d32f0>]}
[0m19:45:22.080793 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 4.28s]
[0m19:45:22.081997 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m19:45:22.082767 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m19:45:22.083685 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.mart_fullmoon_reviews ......................... [RUN]
[0m19:45:22.084432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now model.dbtlearn.mart_fullmoon_reviews)
[0m19:45:22.084937 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m19:45:22.089892 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m19:45:22.091095 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m19:45:22.094605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m19:45:22.096120 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m19:45:22.096545 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.DEV.mart_fullmoon_reviews
         as
        (
WITH fct_reviews AS (
 SELECT * FROM AIRBNB.DEV.fct_reviews
),
full_moon_dates AS (
 SELECT * FROM AIRBNB.DEV.seed_full_moon_dates
)
SELECT
    r.*,
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon'
    END AS is_full_moon
FROM
 fct_reviews r
 LEFT JOIN full_moon_dates fm
 ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
        );
[0m19:45:22.096946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:26.329004 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.232 seconds
[0m19:45:26.335144 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m19:45:26.883409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4899de41-ec1f-4ed4-ba99-60c47f35cc89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e514f20>]}
[0m19:45:26.884959 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 4.80s]
[0m19:45:26.886135 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m19:45:26.887997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:26.888404 [debug] [MainThread]: Connection 'list_AIRBNB_DEV' was properly closed.
[0m19:45:26.888741 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m19:45:26.889270 [info ] [MainThread]: 
[0m19:45:26.889722 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 24.80 seconds (24.80s).
[0m19:45:26.891293 [debug] [MainThread]: Command end result
[0m19:45:26.923805 [info ] [MainThread]: 
[0m19:45:26.924213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:45:26.924490 [info ] [MainThread]: 
[0m19:45:26.924767 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:45:26.927412 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.034296, "process_user_time": 2.64843, "process_kernel_time": 0.374579, "process_mem_max_rss": "185466880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:45:26.927908 [debug] [MainThread]: Command `dbt run` succeeded at 19:45:26.927833 after 26.03 seconds
[0m19:45:26.928216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106040140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3d8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f93aa0>]}
[0m19:45:26.928494 [debug] [MainThread]: Flushing usage events
[0m19:55:58.368586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d5b0>]}


============================== 19:55:58.372874 | 1547dbe2-5b9f-491a-a583-ff7090892f28 ==============================
[0m19:55:58.372874 [info ] [MainThread]: Running with dbt=1.8.8
[0m19:55:58.373366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:55:59.318266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1547dbe2-5b9f-491a-a583-ff7090892f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105539a30>]}
[0m19:55:59.356849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1547dbe2-5b9f-491a-a583-ff7090892f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1cb00>]}
[0m19:55:59.357660 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m19:55:59.372240 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m19:55:59.468126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:55:59.468478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:55:59.499493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1547dbe2-5b9f-491a-a583-ff7090892f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfc7b30>]}
[0m19:55:59.596005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1547dbe2-5b9f-491a-a583-ff7090892f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2844a0>]}
[0m19:55:59.596417 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 454 macros
[0m19:55:59.596682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1547dbe2-5b9f-491a-a583-ff7090892f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c052990>]}
[0m19:55:59.598224 [info ] [MainThread]: 
[0m19:55:59.598668 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:55:59.602009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m19:55:59.615774 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:55:59.616049 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m19:55:59.616265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:02.900782 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.284 seconds
[0m19:56:02.905717 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:56:03.344413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1547dbe2-5b9f-491a-a583-ff7090892f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c03eff0>]}
[0m19:56:03.345608 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:56:03.346201 [info ] [MainThread]: 
[0m19:56:03.349954 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m19:56:03.350541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m19:56:03.351020 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m19:56:03.362085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m19:56:03.365596 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m19:56:03.366107 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m19:56:03.366610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m19:56:03.367034 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m19:56:03.369755 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m19:56:03.371078 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m19:56:03.371459 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m19:56:03.371896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m19:56:03.372215 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m19:56:03.374809 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m19:56:03.375857 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m19:56:03.376227 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m19:56:03.376587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now seed.dbtlearn.seed_full_moon_dates)
[0m19:56:03.376936 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m19:56:03.378643 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m19:56:03.379171 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m19:56:03.379490 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m19:56:03.379791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtlearn.seed_full_moon_dates, now model.dbtlearn.dim_hosts_cleansed)
[0m19:56:03.380046 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m19:56:03.384177 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m19:56:03.384860 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m19:56:03.385438 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m19:56:03.385768 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m19:56:03.386121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m19:56:03.386450 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m19:56:03.391992 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m19:56:03.392937 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m19:56:03.393439 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m19:56:03.393717 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m19:56:03.394006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m19:56:03.394265 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m19:56:03.402256 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m19:56:03.402980 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m19:56:03.403452 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m19:56:03.403735 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m19:56:03.404018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m19:56:03.404278 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m19:56:03.406409 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m19:56:03.407025 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m19:56:03.407444 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m19:56:03.407698 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m19:56:03.407953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now model.dbtlearn.mart_fullmoon_reviews)
[0m19:56:03.408176 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m19:56:03.410413 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m19:56:03.411047 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m19:56:03.411468 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m19:56:03.412119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:56:03.412367 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m19:56:03.413205 [debug] [MainThread]: Command end result
[0m19:56:03.440335 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.1237164, "process_user_time": 1.878319, "process_kernel_time": 0.361265, "process_mem_max_rss": "195543040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:56:03.440805 [debug] [MainThread]: Command `dbt compile` succeeded at 19:56:03.440731 after 5.12 seconds
[0m19:56:03.441090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d820>]}
[0m19:56:03.441347 [debug] [MainThread]: Flushing usage events
[0m20:01:35.839465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea1580>]}


============================== 20:01:35.843430 | 045f8c39-7e48-4820-bdbb-28c7d1de45db ==============================
[0m20:01:35.843430 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:01:35.843902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:01:36.769834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '045f8c39-7e48-4820-bdbb-28c7d1de45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad93620>]}
[0m20:01:36.808126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '045f8c39-7e48-4820-bdbb-28c7d1de45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae02d50>]}
[0m20:01:36.808966 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:01:36.823352 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:01:36.923062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:01:36.923422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:01:36.954357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '045f8c39-7e48-4820-bdbb-28c7d1de45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a04b1a0>]}
[0m20:01:37.029165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '045f8c39-7e48-4820-bdbb-28c7d1de45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b48b710>]}
[0m20:01:37.029580 [info ] [MainThread]: Found 1 seed, 8 models, 3 sources, 454 macros
[0m20:01:37.029849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '045f8c39-7e48-4820-bdbb-28c7d1de45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b271be0>]}
[0m20:01:37.031261 [info ] [MainThread]: 
[0m20:01:37.031681 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:01:37.035102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m20:01:37.048346 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m20:01:37.048621 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m20:01:37.048840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:01:39.807687 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.759 seconds
[0m20:01:39.812730 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m20:01:40.282831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '045f8c39-7e48-4820-bdbb-28c7d1de45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3173b0>]}
[0m20:01:40.283782 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 0 sources
[0m20:01:40.284301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:01:40.284704 [info ] [MainThread]: 
[0m20:01:40.288340 [debug] [Thread-1 (]: Began running node source.dbtlearn.airbnb.reviews
[0m20:01:40.288885 [info ] [Thread-1 (]: 1 of 1 START freshness of airbnb.reviews ....................................... [RUN]
[0m20:01:40.289433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now source.dbtlearn.airbnb.reviews)
[0m20:01:40.289860 [debug] [Thread-1 (]: Began compiling node source.dbtlearn.airbnb.reviews
[0m20:01:40.290279 [debug] [Thread-1 (]: Began executing node source.dbtlearn.airbnb.reviews
[0m20:01:40.301810 [debug] [Thread-1 (]: Using snowflake connection "source.dbtlearn.airbnb.reviews"
[0m20:01:40.302263 [debug] [Thread-1 (]: On source.dbtlearn.airbnb.reviews: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "source.dbtlearn.airbnb.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from AIRBNB.raw.raw_reviews
[0m20:01:40.302663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:01:42.353284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.050 seconds
[0m20:01:42.358813 [debug] [Thread-1 (]: On source.dbtlearn.airbnb.reviews: Close
[0m20:01:42.801584 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of airbnb.reviews ................................. [[31mERROR STALE[0m in 2.51s]
[0m20:01:42.802767 [debug] [Thread-1 (]: Finished running node source.dbtlearn.airbnb.reviews
[0m20:01:42.805514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:42.806026 [debug] [MainThread]: Connection 'source.dbtlearn.airbnb.reviews' was properly closed.
[0m20:01:42.806468 [info ] [MainThread]: 
[0m20:01:42.806912 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m20:01:42.837791 [info ] [MainThread]: 
[0m20:01:42.838155 [info ] [MainThread]: Done.
[0m20:01:42.840810 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 7.0528545, "process_user_time": 1.934075, "process_kernel_time": 0.350874, "process_mem_max_rss": "190103552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:01:42.841511 [debug] [MainThread]: Command `dbt source freshness` failed at 20:01:42.841376 after 7.05 seconds
[0m20:01:42.841949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053dc140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5dbe0>]}
[0m20:01:42.842299 [debug] [MainThread]: Flushing usage events
[0m20:33:03.193414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083556a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108355370>]}


============================== 20:33:03.197385 | f9ba96c0-da37-4f76-a4bc-5dea1efd79c0 ==============================
[0m20:33:03.197385 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:33:03.197837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'debug': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:33:04.180165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9ba96c0-da37-4f76-a4bc-5dea1efd79c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d51b4a0>]}
[0m20:33:04.218753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9ba96c0-da37-4f76-a4bc-5dea1efd79c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c25970>]}
[0m20:33:04.219595 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:33:04.234092 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:33:04.336246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:33:04.336722 [debug] [MainThread]: Partial parsing: added file: dbtlearn://snapshots/scd_raw_listings.sql
[0m20:33:04.537184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9ba96c0-da37-4f76-a4bc-5dea1efd79c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac4b60>]}
[0m20:33:04.619354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9ba96c0-da37-4f76-a4bc-5dea1efd79c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da73ad0>]}
[0m20:33:04.619773 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 454 macros
[0m20:33:04.620037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9ba96c0-da37-4f76-a4bc-5dea1efd79c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5e6ed0>]}
[0m20:33:04.621438 [info ] [MainThread]: 
[0m20:33:04.621867 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:33:04.622518 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m20:33:04.632887 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m20:33:04.633155 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m20:33:04.633365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:08.282849 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.649 seconds
[0m20:33:08.286319 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:33:08.763014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m20:33:08.774602 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m20:33:08.775022 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m20:33:08.775342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:09.808977 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.033 seconds
[0m20:33:09.814182 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m20:33:10.259460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9ba96c0-da37-4f76-a4bc-5dea1efd79c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac73e0>]}
[0m20:33:10.260444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:33:10.260896 [info ] [MainThread]: 
[0m20:33:10.264772 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m20:33:10.265571 [info ] [Thread-1 (]: 1 of 1 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m20:33:10.266185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.dbtlearn.scd_raw_listings)
[0m20:33:10.266663 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m20:33:10.277710 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m20:33:10.339029 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:33:10.339456 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        


select * FROM AIRBNB.raw.raw_listings

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m20:33:10.339734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:11.886810 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.547 seconds
[0m20:33:11.898934 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:33:11.899574 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:33:12.145214 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.245 seconds
[0m20:33:12.147046 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m20:33:12.150129 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:33:12.150661 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
create or replace transient table AIRBNB.DEV.scd_raw_listings
         as
        (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        


select * FROM AIRBNB.raw.raw_listings

    ) sbq



        );
[0m20:33:14.040795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.889 seconds
[0m20:33:14.077181 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m20:33:14.526803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ba96c0-da37-4f76-a4bc-5dea1efd79c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d558950>]}
[0m20:33:14.528362 [info ] [Thread-1 (]: 1 of 1 OK snapshotted DEV.scd_raw_listings ..................................... [[32mSUCCESS 1[0m in 4.26s]
[0m20:33:14.529444 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m20:33:14.531215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:14.531621 [debug] [MainThread]: Connection 'list_AIRBNB' was properly closed.
[0m20:33:14.531964 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m20:33:14.532324 [info ] [MainThread]: 
[0m20:33:14.532722 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 9.91 seconds (9.91s).
[0m20:33:14.533539 [debug] [MainThread]: Command end result
[0m20:33:14.565372 [info ] [MainThread]: 
[0m20:33:14.565774 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:14.566029 [info ] [MainThread]: 
[0m20:33:14.566280 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:33:14.606661 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 11.472516, "process_user_time": 2.44337, "process_kernel_time": 0.462855, "process_mem_max_rss": "198082560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:33:14.607236 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:33:14.607150 after 11.47 seconds
[0m20:33:14.607569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108355370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f581d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d778860>]}
[0m20:33:14.607870 [debug] [MainThread]: Flushing usage events
[0m20:36:39.124265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b3b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108585670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108585370>]}


============================== 20:36:39.128420 | a8cc248b-9353-404f-a877-a7912c09f29a ==============================
[0m20:36:39.128420 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:36:39.128938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m20:36:40.067617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8cc248b-9353-404f-a877-a7912c09f29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d661160>]}
[0m20:36:40.105750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8cc248b-9353-404f-a877-a7912c09f29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7874a0>]}
[0m20:36:40.106565 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:36:40.120918 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:36:40.231025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:40.231381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:40.269832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8cc248b-9353-404f-a877-a7912c09f29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a37a0>]}
[0m20:36:40.354065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8cc248b-9353-404f-a877-a7912c09f29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbb3920>]}
[0m20:36:40.354492 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 454 macros
[0m20:36:40.354755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8cc248b-9353-404f-a877-a7912c09f29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d95a600>]}
[0m20:36:40.356190 [info ] [MainThread]: 
[0m20:36:40.356617 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:40.357272 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m20:36:40.369342 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m20:36:40.369632 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m20:36:40.369855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:41.689589 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.319 seconds
[0m20:36:41.693762 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:36:42.150163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m20:36:42.163690 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m20:36:42.164164 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m20:36:42.164492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:43.167799 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.003 seconds
[0m20:36:43.172927 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m20:36:43.617409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8cc248b-9353-404f-a877-a7912c09f29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbb3b90>]}
[0m20:36:43.618430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:43.619017 [info ] [MainThread]: 
[0m20:36:43.622718 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m20:36:43.623458 [info ] [Thread-1 (]: 1 of 1 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m20:36:43.624063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.dbtlearn.scd_raw_listings)
[0m20:36:43.624540 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m20:36:43.635583 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m20:36:43.682636 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:43.683001 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m20:36:43.683247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:44.812328 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 1.129 seconds
[0m20:36:44.857602 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:44.858209 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
         as
        (

    with snapshot_query as (

        


select * FROM AIRBNB.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:36:46.212315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.353 seconds
[0m20:36:46.219305 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:46.219980 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m20:36:46.467621 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.247 seconds
[0m20:36:46.477256 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:46.477809 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m20:36:46.716091 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.237 seconds
[0m20:36:46.725076 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:46.725643 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m20:36:46.996635 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.270 seconds
[0m20:36:47.004134 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:47.004734 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m20:36:47.238545 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.233 seconds
[0m20:36:47.252016 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:47.252638 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m20:36:47.488750 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.235 seconds
[0m20:36:47.519951 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:47.520610 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        

    with snapshot_query as (

        


select * FROM AIRBNB.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m20:36:48.131723 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.610 seconds
[0m20:36:48.138392 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:48.138920 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:36:48.373251 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.234 seconds
[0m20:36:48.374903 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:48.379179 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:48.379793 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
BEGIN
[0m20:36:48.633013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.252 seconds
[0m20:36:48.634368 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:48.635315 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:36:50.206305 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.570 seconds
[0m20:36:50.207918 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:36:50.208571 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
COMMIT
[0m20:36:50.553495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.344 seconds
[0m20:36:50.584567 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m20:36:51.027077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8cc248b-9353-404f-a877-a7912c09f29a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d784a10>]}
[0m20:36:51.028574 [info ] [Thread-1 (]: 1 of 1 OK snapshotted DEV.scd_raw_listings ..................................... [[32mSUCCESS 2[0m in 7.40s]
[0m20:36:51.029450 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m20:36:51.031099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:51.031513 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m20:36:51.031902 [info ] [MainThread]: 
[0m20:36:51.032300 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 10.68 seconds (10.68s).
[0m20:36:51.033157 [debug] [MainThread]: Command end result
[0m20:36:51.064782 [info ] [MainThread]: 
[0m20:36:51.065222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:51.065492 [info ] [MainThread]: 
[0m20:36:51.065749 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:51.068531 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 11.996016, "process_user_time": 2.325073, "process_kernel_time": 0.366295, "process_mem_max_rss": "195756032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:36:51.069075 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:36:51.068985 after 12.00 seconds
[0m20:36:51.069417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f40500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce43fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd6f00>]}
[0m20:36:51.069714 [debug] [MainThread]: Flushing usage events
[0m20:38:38.953397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a358b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a355b0>]}


============================== 20:38:38.957302 | fd2442fa-8c14-4f94-9a7d-ba4226101b6d ==============================
[0m20:38:38.957302 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:38:38.957774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m20:38:39.714960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd2442fa-8c14-4f94-9a7d-ba4226101b6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e780b0>]}
[0m20:38:39.753817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd2442fa-8c14-4f94-9a7d-ba4226101b6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c93c5f0>]}
[0m20:38:39.754604 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:38:39.768681 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:38:39.879126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:38:39.879496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:38:39.918274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd2442fa-8c14-4f94-9a7d-ba4226101b6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc9be60>]}
[0m20:38:40.002263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd2442fa-8c14-4f94-9a7d-ba4226101b6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0538f0>]}
[0m20:38:40.002678 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 454 macros
[0m20:38:40.002953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd2442fa-8c14-4f94-9a7d-ba4226101b6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de0dc70>]}
[0m20:38:40.004378 [info ] [MainThread]: 
[0m20:38:40.004820 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:38:40.005500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m20:38:40.017553 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m20:38:40.017835 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m20:38:40.018060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:41.217420 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.199 seconds
[0m20:38:41.220484 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:38:41.672590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m20:38:41.686620 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m20:38:41.687085 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m20:38:41.687412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:42.928135 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.240 seconds
[0m20:38:42.933544 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m20:38:43.381927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd2442fa-8c14-4f94-9a7d-ba4226101b6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e8bf0>]}
[0m20:38:43.382906 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:38:43.383488 [info ] [MainThread]: 
[0m20:38:43.387075 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m20:38:43.387759 [info ] [Thread-1 (]: 1 of 1 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m20:38:43.388320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.dbtlearn.scd_raw_listings)
[0m20:38:43.388771 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m20:38:43.399969 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m20:38:43.447546 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:43.447938 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m20:38:43.448201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:44.461184 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 1.013 seconds
[0m20:38:44.505784 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:44.506423 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
         as
        (

    with snapshot_query as (

        


select * FROM AIRBNB.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:38:46.335989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.829 seconds
[0m20:38:46.342779 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:46.343377 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m20:38:46.590361 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.246 seconds
[0m20:38:46.599249 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:46.599860 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m20:38:46.835861 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.235 seconds
[0m20:38:46.844352 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:46.844968 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m20:38:47.105409 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.260 seconds
[0m20:38:47.113648 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:47.114198 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m20:38:47.354911 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.240 seconds
[0m20:38:47.366531 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:47.367029 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m20:38:47.623934 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.256 seconds
[0m20:38:47.655847 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:47.656461 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        

    with snapshot_query as (

        


select * FROM AIRBNB.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m20:38:48.274303 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.617 seconds
[0m20:38:48.282572 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:48.283173 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:38:48.513627 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.230 seconds
[0m20:38:48.515631 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:48.520648 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:48.521255 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
BEGIN
[0m20:38:48.781474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m20:38:48.782785 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:48.783583 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:38:50.935771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.151 seconds
[0m20:38:50.936963 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:38:50.937670 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
COMMIT
[0m20:38:51.518468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m20:38:51.550339 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m20:38:53.177536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd2442fa-8c14-4f94-9a7d-ba4226101b6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc38b90>]}
[0m20:38:53.179287 [info ] [Thread-1 (]: 1 of 1 OK snapshotted DEV.scd_raw_listings ..................................... [[32mSUCCESS 1[0m in 9.79s]
[0m20:38:53.180232 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m20:38:53.181873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:53.182349 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m20:38:53.182800 [info ] [MainThread]: 
[0m20:38:53.183246 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 13.18 seconds (13.18s).
[0m20:38:53.184105 [debug] [MainThread]: Command end result
[0m20:38:53.216120 [info ] [MainThread]: 
[0m20:38:53.216550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:38:53.216812 [info ] [MainThread]: 
[0m20:38:53.217076 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:38:53.219768 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 14.3171, "process_user_time": 2.329578, "process_kernel_time": 0.29501, "process_mem_max_rss": "194150400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:38:53.220294 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:38:53.220210 after 14.32 seconds
[0m20:38:53.220637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108410140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083dac00>]}
[0m20:38:53.220980 [debug] [MainThread]: Flushing usage events
[0m20:41:28.595335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10432aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da5160>]}


============================== 20:41:28.599402 | 5d7c8ff4-589c-4621-a0d7-8deebc2ea4b1 ==============================
[0m20:41:28.599402 [info ] [MainThread]: Running with dbt=1.8.8
[0m20:41:28.599861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/yeniwijayanti/dbtlearn/logs', 'debug': 'False', 'profiles_dir': '/Users/yeniwijayanti/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:41:29.359431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d7c8ff4-589c-4621-a0d7-8deebc2ea4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a40680>]}
[0m20:41:29.400184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d7c8ff4-589c-4621-a0d7-8deebc2ea4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f16660>]}
[0m20:41:29.401105 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:41:29.415041 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m20:41:29.527914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:41:29.528424 [debug] [MainThread]: Partial parsing: added file: dbtlearn://snapshots/scd_raw_hosts.sql
[0m20:41:29.719640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d7c8ff4-589c-4621-a0d7-8deebc2ea4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a511100>]}
[0m20:41:29.803081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d7c8ff4-589c-4621-a0d7-8deebc2ea4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4eae10>]}
[0m20:41:29.803511 [info ] [MainThread]: Found 1 seed, 8 models, 2 snapshots, 3 sources, 454 macros
[0m20:41:29.803785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d7c8ff4-589c-4621-a0d7-8deebc2ea4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2b4da0>]}
[0m20:41:29.805226 [info ] [MainThread]: 
[0m20:41:29.805644 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:41:29.808782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m20:41:29.819208 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m20:41:29.819478 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m20:41:29.819695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:31.883530 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.063 seconds
[0m20:41:31.887492 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:41:32.350574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m20:41:32.364511 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m20:41:32.364948 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m20:41:32.365281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:33.937875 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.572 seconds
[0m20:41:33.943255 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m20:41:34.399124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d7c8ff4-589c-4621-a0d7-8deebc2ea4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105122420>]}
[0m20:41:34.399987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:34.400428 [info ] [MainThread]: 
[0m20:41:34.404285 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_hosts
[0m20:41:34.404973 [info ] [Thread-1 (]: 1 of 2 START snapshot DEV.scd_raw_hosts ........................................ [RUN]
[0m20:41:34.405637 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.dbtlearn.scd_raw_hosts'
[0m20:41:34.406082 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_hosts
[0m20:41:34.417112 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_hosts
[0m20:41:34.479518 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_hosts"
[0m20:41:34.479921 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        


select * FROM AIRBNB.raw.raw_hosts

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m20:41:34.480205 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:41:35.716669 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.236 seconds
[0m20:41:35.729010 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_hosts"
[0m20:41:35.729712 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:41:35.975220 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.245 seconds
[0m20:41:35.977158 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_hosts"
[0m20:41:35.980135 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_hosts"
[0m20:41:35.980894 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_hosts"} */
create or replace transient table AIRBNB.DEV.scd_raw_hosts
         as
        (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        


select * FROM AIRBNB.raw.raw_hosts

    ) sbq



        );
[0m20:41:37.543927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.562 seconds
[0m20:41:37.580073 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_hosts: Close
[0m20:41:38.031521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d7c8ff4-589c-4621-a0d7-8deebc2ea4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8bc4d0>]}
[0m20:41:38.032683 [info ] [Thread-1 (]: 1 of 2 OK snapshotted DEV.scd_raw_hosts ........................................ [[32mSUCCESS 1[0m in 3.62s]
[0m20:41:38.033574 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_hosts
[0m20:41:38.034176 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m20:41:38.034961 [info ] [Thread-1 (]: 2 of 2 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m20:41:38.035699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearn.scd_raw_hosts, now snapshot.dbtlearn.scd_raw_listings)
[0m20:41:38.036200 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m20:41:38.041057 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m20:41:38.053357 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:38.053740 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m20:41:38.054067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:39.235315 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 1.181 seconds
[0m20:41:39.265083 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:39.265808 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
         as
        (

    with snapshot_query as (

        


select * FROM AIRBNB.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m20:41:40.347666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.081 seconds
[0m20:41:40.354662 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:40.355369 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m20:41:40.621008 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.265 seconds
[0m20:41:40.631017 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:40.631609 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m20:41:40.876198 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.244 seconds
[0m20:41:40.884723 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:40.885264 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m20:41:41.132721 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.247 seconds
[0m20:41:41.140235 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:41.140769 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m20:41:41.375539 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.234 seconds
[0m20:41:41.389062 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:41.389634 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m20:41:41.842397 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.452 seconds
[0m20:41:41.863073 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:41.863729 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        

    with snapshot_query as (

        


select * FROM AIRBNB.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m20:41:42.375504 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.511 seconds
[0m20:41:42.378473 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:42.379006 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m20:41:42.615466 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.236 seconds
[0m20:41:42.617271 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:42.621879 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:42.622585 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
BEGIN
[0m20:41:42.876064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.253 seconds
[0m20:41:42.877378 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:42.878461 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m20:41:43.446099 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.567 seconds
[0m20:41:43.447272 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m20:41:43.447848 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
COMMIT
[0m20:41:43.738665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.290 seconds
[0m20:41:43.746982 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m20:41:44.191522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d7c8ff4-589c-4621-a0d7-8deebc2ea4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a88dac0>]}
[0m20:41:44.193139 [info ] [Thread-1 (]: 2 of 2 OK snapshotted DEV.scd_raw_listings ..................................... [[32mSUCCESS 0[0m in 6.16s]
[0m20:41:44.194245 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m20:41:44.196155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:44.196534 [debug] [MainThread]: Connection 'list_AIRBNB_DEV' was properly closed.
[0m20:41:44.196866 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m20:41:44.197254 [info ] [MainThread]: 
[0m20:41:44.197670 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 14.39 seconds (14.39s).
[0m20:41:44.198672 [debug] [MainThread]: Command end result
[0m20:41:44.230415 [info ] [MainThread]: 
[0m20:41:44.230855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:44.231121 [info ] [MainThread]: 
[0m20:41:44.231381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:41:44.234098 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 15.691076, "process_user_time": 2.613409, "process_kernel_time": 0.313167, "process_mem_max_rss": "200081408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:41:44.234666 [debug] [MainThread]: Command `dbt snapshot` succeeded at 20:41:44.234583 after 15.69 seconds
[0m20:41:44.235002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043549e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da5340>]}
[0m20:41:44.235301 [debug] [MainThread]: Flushing usage events
